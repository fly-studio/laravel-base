{"version":3,"sources":["laravel.select.js"],"names":["$","method","cacheData","getData","url","params","key","JSON","stringify","$dfd","jQuery","Deferred","resolve","LP","post","done","json","textStatus","jqXHR","items","data","fail","args","arguments","reject","apply","promise","replaceData","format","replace","$0","$1","o","split","d","i","length","n","id","selection","text","pid","result","children","push","recursive","prefix","v","_class","ds","j","fn","extend","selectModel","options","this","select2","each","$this","values","attr","val","baseuri","all","language","allowClear","trigger","treeModel","tree","templateResult","templateSelection","suggestModel","term","q","_config","ajax","delay","transport","_params","success","failure","config","page","f","like","processResults","results","escapeMarkup","markup","minimumInputLength","in","tagsModel","createTag","trim","newTag","ready"],"mappings":"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","file":"laravel.select.min.js","sourcesContent":["(function($){\r\n\tvar method = {cacheData: {}};\r\n\tmethod.getData = function(url, params) {\r\n\t\tvar key = JSON.stringify({url: url, params: params});\r\n\t\tvar $dfd = jQuery.Deferred();\r\n\r\n\t\tif (typeof method.cacheData[key] != 'undefined')\r\n\t\t\t$dfd.resolve(method.cacheData[key]);\r\n\t\telse {\r\n\t\t\tLP.post(url, params).done(function(json, textStatus, jqXHR){\r\n\t\t\t\tvar items = json.data.data;\r\n\t\t\t\tmethod.cacheData[key] = items;\r\n\t\t\t\t$dfd.resolve(method.cacheData[key]);\r\n\t\t\t}).fail(function(){\r\n\t\t\t\tvar args = arguments;\r\n\t\t\t\t$dfd.reject.apply($dfd, args);\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn $dfd.promise();\r\n\t};\r\n\tmethod.replaceData = function(data, format)\r\n\t{\r\n\t\treturn format.replace(/\\{\\{([\\w\\.]+)\\}\\}/g, function($0, $1){\r\n\t\t\tvar o = $1.split('.');\r\n\t\t\tvar d = data;\r\n\t\t\tfor(var i = 0; i < o.length; ++i)\r\n\t\t\t{\r\n\t\t\t\tvar n = o[i];\r\n\t\t\t\tif (typeof d[ n ] != 'undefined')\r\n\t\t\t\t\td = d[n];\r\n\t\t\t\telse \r\n\t\t\t\t\treturn null;\r\n\t\t\t}\r\n\t\t\treturn d;\r\n\t\t});\r\n\t};\r\n\tmethod.format = function(items, id, selection, text, pid) {\r\n\t\tvar result = [];\r\n\t\tfor(var i = 0; i < items.length; ++i) {\r\n\t\t\tvar d = {\r\n\t\t\t\t'id': id ? method.replaceData(items[i], id) : items[i].id, \r\n\t\t\t\t'text': text ? method.replaceData(items[i], text) : items[i].text,\r\n\t\t\t\t'selection': selection ? method.replaceData(items[i], selection) : items[i].selection,\r\n\t\t\t\t'pid': pid ? method.replaceData(items[i], pid) : items[i].pid\r\n\t\t\t};\r\n\t\t\tif (typeof items[i].children == 'object' && typeof items[i].children.length != 'undefined')\r\n\t\t\t\td.children = method.format(items[i].children, id, selection, text, pid);\r\n\t\t\tresult.push(d);\r\n\t\t}\r\n\t\treturn result;\r\n\t};\r\n\tmethod.recursive = function(items, prefix) {\r\n\t\tprefix = typeof prefix == 'undefined' ? '' : prefix;\r\n\t\tvar result = [];\r\n\t\tfor(var i = 0; i < items.length; ++i) {\r\n\t\t\tvar v = items[i];\r\n\t\t\tvar _class = 'treeline ';\r\n\t\t\tif (i === 0 && !prefix) //首节点\r\n\t\t\t\t_class += 'top-';\r\n\t\t\telse if (i == items.length - 1) //尾节点\r\n\t\t\t\t_class += 'bottom-';\r\n\t\t\telse\r\n\t\t\t\t_class += 'center-';\r\n\t\t\t_class += v.children ? 'open' : 'line';\r\n\r\n\t\t\tvar d = {\r\n\t\t\t\t'id': v.id,\r\n\t\t\t\t'selection': v.selection,\r\n\t\t\t\t'text': prefix + '<span class=\"'+_class+'\"></span>' + v.text\r\n\t\t\t};\r\n\t\t\tresult.push(d);\r\n\t\t\tif (v.children)\r\n\t\t\t{\r\n\t\t\t\tvar ds = method.recursive(v.children, prefix + (i == items.length - 1 ? '<span class=\"treeline blank\"></span>' : '<span class=\"treeline blank-line\"></span>'));\r\n\t\t\t\tfor(var j = 0; j < ds.length; ++j)\r\n\t\t\t\t\tresult.push(ds[j]);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t};\r\n\t$.fn.extend({\r\n\t\tselectModel: function(options){\r\n\t\t\tif (options == 'destroy') return this.select2('destroy');\r\n\t\t\tif (options == 'open') return this.select2('open');\r\n\t\t\tif (options == 'close') return this.select2('close');\r\n\t\t\treturn this.each(function(){\r\n\t\t\t\tvar $this = $(this);\r\n\t\t\t\tvar id = $this.data('id');\r\n\t\t\t\tvar text = $this.data('text');\r\n\t\t\t\tvar selection = $this.data('selection') ? $this.data('selection') : text;\r\n\t\t\t\tvar params = $this.data('params');\r\n\t\t\t\tvar values = $this.attr('value') ? $this.attr('value').split(',') : $this.val();\r\n\t\t\t\tvar url = LP.baseuri + $this.data('model')+'/data/json';\r\n\t\t\t\tparams = $.extend(true, {}, {all: 'true'}, params);\r\n\t\t\t\tmethod.getData(url, params).done(function(json){\r\n\t\t\t\t\tvar data = method.format(json, id, selection, text); \r\n\t\t\t\t\t$this.select2($.extend(true, {}, {language: \"zh-CN\", data: data, allowClear: true}, options));\r\n\t\t\t\t\t//初始值\r\n\t\t\t\t\t$this.val(values ? values : null).trigger(\"change\");\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t},\r\n\t\ttreeModel: function(options){\r\n\t\t\tif (options == 'destroy') return this.select2('destroy');\r\n\t\t\tif (options == 'open') return this.select2('open');\r\n\t\t\tif (options == 'close') return this.select2('close');\r\n\t\t\treturn this.each(function(){\r\n\t\t\t\tvar $this = $(this);\r\n\t\t\t\tvar id = $this.data('id');\r\n\t\t\t\tvar pid = $this.data('pid');\r\n\t\t\t\tvar text = $this.data('text');\r\n\t\t\t\tvar selection = $this.data('selection') ? $this.data('selection') : text;\r\n\t\t\t\tvar params = $this.data('params');\r\n\t\t\t\tvar values = $this.attr('value') ? $this.attr('value').split(',') : $this.val();\r\n\t\t\t\tvar url = LP.baseuri + $this.data('model')+'/data/json';\r\n\t\t\t\tparams = $.extend(true, {}, {all: 'true', tree: 'true'}, params);\r\n\r\n\t\t\t\tmethod.getData(url, params).done(function(json){\r\n\t\t\t\t\tvar data = method.format(json, id, selection, text, pid);\r\n\t\t\t\t\tdata = method.recursive(data);\r\n\t\t\t\t\t$this.select2($.extend(true, {}, {\r\n\t\t\t\t\t\t//theme: \"bootstrap\",\r\n\t\t\t\t\t\tlanguage: \"zh-CN\",data: data, allowClear: true,\r\n\t\t\t\t\t\ttemplateResult: function(data){return $('<div>' + data.text + '</div>');},\r\n\t\t\t\t\t\ttemplateSelection: function(data){return data.selection;}\r\n\t\t\t\t\t}, options));\r\n\t\t\t\t\t//初始值\r\n\t\t\t\t\t$this.val(values ? values : null).trigger(\"change\");\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t},\r\n\t\tsuggestModel: function(options){\r\n\t\t\tif (options == 'destroy') return this.select2('destroy');\r\n\t\t\tif (options == 'open') return this.select2('open');\r\n\t\t\tif (options == 'close') return this.select2('close');\r\n\t\t\treturn this.each(function(){\r\n\t\t\t\tvar $this = $(this);\r\n\t\t\t\tvar id = $this.data('id');\r\n\t\t\t\tvar text = $this.data('text');\r\n\t\t\t\tvar selection = $this.data('selection') ? $this.data('selection') : text;\r\n\t\t\t\tvar term = $this.data('term') ? $this.data('term') : null;\r\n\t\t\t\tvar q = $this.data('q') ? $this.data('q') : null;\r\n\t\t\t\tvar values = $this.attr('value') ? $this.attr('value').split(',') : $this.val();\r\n\t\t\t\tvar url = LP.baseuri + $this.data('model') + '/data/json';\r\n\t\t\t\tvar _config = {\r\n\t\t\t\t\tlanguage: \"zh-CN\",\r\n\t\t\t\t\tajax: {\r\n\t\t\t\t\t\tdelay: 500,\r\n\t\t\t\t\t\t//dataType: 'json',\r\n\t\t\t\t\t\t//type: 'post',\r\n\t\t\t\t\t\t//cache: true,\r\n\t\t\t\t\t\ttransport: function (_params, success, failure) {\r\n\t\t\t\t\t\t\tvar params = $this.data('params');\r\n\t\t\t\t\t\t\tvar config = {page: _params.data.page, f: {}, q: {}};\r\n\t\t\t\t\t\t\tif(term) config.f[term] = {'like': _params.data.term};\r\n\t\t\t\t\t\t\tif(q) config.q[q] = _params.data.q;\r\n\t\t\t\t\t\t\tmethod.getData(url, $.extend(true, {}, config, params)).done(function(json){\r\n\t\t\t\t\t\t\t\tvar data = method.format(json, id, selection, text);\r\n\t\t\t\t\t\t\t\tsuccess(data);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tprocessResults: function (json, page) {\r\n\t\t\t\t\t\t\treturn {results: json};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tescapeMarkup: function (markup) {return markup;},\r\n\t\t\t\t\tminimumInputLength: 2,\r\n\t\t\t\t\tallowClear: true,\r\n\t\t\t\t\ttemplateResult: function(data){return data.text;},\r\n\t\t\t\t\ttemplateSelection: function(data){return data.selection || data.text;}\r\n\t\t\t\t};\r\n\t\t\t\t//有初始的值\r\n\t\t\t\tif (values) {\r\n\t\t\t\t\tvar params = $this.data('params');\r\n\t\t\t\t\tmethod.getData(url, $.extend(true, {}, params, {f: {id: {in: values}}})).done(function(json){\r\n\t\t\t\t\t\tvar data = method.format(json, id, selection, text);\r\n\t\t\t\t\t\t$this.select2($.extend(true, {}, _config, options, {data: data}));\r\n\r\n\t\t\t\t\t});\r\n\t\t\t\t} else\r\n\t\t\t\t\t$this.select2($.extend(true, {}, _config, options));\r\n\t\t\t});\r\n\t\t},\r\n\t\ttagsModel: function(options){\r\n\t\t\tif (options == 'destroy') return this.select2('destroy');\r\n\t\t\tif (options == 'open') return this.select2('open');\r\n\t\t\tif (options == 'close') return this.select2('close');\r\n\t\t\treturn this.each(function(){\r\n\t\t\t\tvar $this = $(this);\r\n\t\t\t\tvar term = $this.data('term') ? $this.data('term') : null;\r\n\t\t\t\tvar q = $this.data('q') ? $this.data('q') : null;\r\n\t\t\t\tif (!term && !q) term = 'keywords';\r\n\t\t\t\tvar id = $this.data('id') ? $this.data('id') : '{{keywords}}';\r\n\t\t\t\tvar text = $this.data('text') ? $this.data('text') : '{{keywords}} <span class=\"text-muted\">({{count}}次使用)</span>';\r\n\t\t\t\tvar selection = $this.data('selection') ? $this.data('selection') : '{{keywords}}';\r\n\t\t\t\tvar values = $this.attr('value') ? $this.attr('value').split(',') : $this.val();\r\n\t\t\t\tvar url = LP.baseuri + ($this.data('model') ? $this.data('model') : 'admin/tag') + '/data/json';\r\n\t\t\t\tvar _config = {\r\n\t\t\t\t\tlanguage: \"zh-CN\",\r\n\t\t\t\t\tajax: {\r\n\t\t\t\t\t\tdelay: 500,\r\n\t\t\t\t\t\t//dataType: 'json',\r\n\t\t\t\t\t\t//type: 'post',\r\n\t\t\t\t\t\t//cache: true,\r\n\t\t\t\t\t\ttransport: function (_params, success, failure) {\r\n\t\t\t\t\t\t\tvar params = $this.data('params');\r\n\t\t\t\t\t\t\tvar config = {page: _params.data.page, f: {}, q: {}};\r\n\t\t\t\t\t\t\tif(term) config.f[term] = {'like': _params.data.term};\r\n\t\t\t\t\t\t\tif(q) config.q[q] = _params.data.q;\r\n\t\t\t\t\t\t\tmethod.getData(url, $.extend(true, {}, config, params)).done(function(json){\r\n\t\t\t\t\t\t\t\tvar data = method.format(json, id, selection, text);\r\n\t\t\t\t\t\t\t\tsuccess(data);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tprocessResults: function (json, page) {\r\n\t\t\t\t\t\t\treturn {results: json};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tescapeMarkup: function (markup) {return markup;},\r\n\t\t\t\t\tminimumInputLength: 1,\r\n\t\t\t\t\ttemplateResult: function(data){return data.text;},\r\n\t\t\t\t\ttemplateSelection: function(data){return data.selection || data.text;},\r\n\t\t\t\t\tcreateTag: function (_params) {\r\n\t\t\t\t\t\tvar term = $.trim(_params.term);\r\n\t\t\t\t\t\tif (term === '') return null;\r\n\t\t\t\t\t\treturn {\r\n\t\t\t\t\t\t\tid: term,\r\n\t\t\t\t\t\t\tselection: term,\r\n\t\t\t\t\t\t\ttext: term + ' <span style=\"color:#f5f5f5\">(创建)</span>',\r\n\t\t\t\t\t\t\tnewTag: true // add additional parameters\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\tif (values) {\r\n\t\t\t\t\tvar params = $this.data('params');\r\n\t\t\t\t\tvar config = {f: {id: {in: values}}, q: {}};\r\n\t\t\t\t\tmethod.getData(url, $.extend(true, {}, config, params)).done(function(json){\r\n\t\t\t\t\t\tvar data = method.format(json, id, selection, text);\r\n\t\t\t\t\t\t$this.select2($.extend(true, {}, _config, options, {data: data}));\r\n\t\t\t\t\t});\r\n\t\t\t\t} else\r\n\t\t\t\t\t$this.select2($.extend(true, {}, _config, options));\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n\r\n$().ready(function(){\r\n\t$('.select-model').selectModel();\r\n\t$('.tree-model').treeModel();\r\n\t$('.suggest-model').suggestModel();\r\n\t$('.tags-model').tagsModel();\r\n});\r\n})(jQuery);"]}