{"version":3,"sources":["table.js"],"names":["$","ready","method","config","$dt","bindMethods","obj","query","json","result","data","id","datatable","url","ajax","reload","forEach","fadeOut","this","remove","layout","modal","is","on","e","target","closest","trigger","$tr","checked","addClass","removeClass","getConfig","configs","r","i","length","bbq","getState","extend","displayStart","pageLength","setConfig","settings","_iDisplayStart","_iDisplayLength","search","oPreviousSearch","sSearch","order","aLastSort","v","push","col","dir","pushState","getColumns","removeIt","each","$t","render","template","compile","html","c","orderable","cellType","tagName","toLowerCase","className","contentPadding","defaultContent","name","orderData","orderDataType","orderSequence","type","full","d","searchable","visible","empty","fn","dataTable","ext","renderer","pageButton","bootstrap","host","idx","buttons","page","pages","btnDisplay","btnClass","activeEl","api","Api","classes","oClasses","lang","oLanguage","oPaginate","aria","oAria","paginate","counter","attach","container","ien","node","button","clickHandler","preventDefault","currentTarget","hasClass","action","draw","isArray","sFirst","sPrevious","sNext","sLast","class","sPageButton","sTableId","append","href","aria-controls","aria-label","data-dt-idx","tabindex","iTabIndex","appendTo","oApi","_fnBindAction","find","document","activeElement","inputPageJump","min","max","val","event","keyCode","curr","value","replace","info","btnPageJump","jump","focus","sWrapper","sFilterInput","sLengthSelect","sProcessing","make","columns","DataTable","dom","language","lengthMenu","zeroRecords","infoEmpty","infoFiltered","searchPlaceholder","previous","next","first","last","processing","column","asSorting","baseuri","namespace","timeout","o","item","queryParams","q","_all","window","location","f","attr","querystring","size","isNaN","start","Math","ceil","dataSrc","recordsTotal","recordsFiltered","k","DT_RowId","showtips","serverSide","deferRender","rowCallback","row","dataIndex","createdRow","tooltip","animation","popover","drawCallback","checkedStatus","prop","stopPropagation","triggerHandler","jQuery"],"mappings":"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","file":"table.min.js","sourcesContent":["(function($){\r\n$().ready(function(){\r\n\tvar method = {config: {}};\r\n\tvar $dt = $('#datatable');\r\n\r\n\tmethod.bindMethods = function(obj){\r\n\r\n\t\t$('a[method]:not([method=\"delete\"])', obj).query();\r\n\t\t$('a[method=\"delete\"]', obj).query(function(json){\r\n\t\t\tif ((json.result == 'success' || json.result == 'api') && json.data.id) {\r\n\t\t\t\tif (method.datatable && json.url === true)\r\n\t\t\t\t\tmethod.datatable.ajax.reload(null, false);\r\n\t\t\t\telse\r\n\t\t\t\t\tjson.data.id.forEach(function(id){\r\n\t\t\t\t\t\t$('#line-'+id).fadeOut(function(){\r\n\t\t\t\t\t\t\t$(this).remove();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t}\r\n\t\t}, {\r\n\t\t\tlayout: 'topCenter',\r\n\t\t\tmodal: false,\r\n\t\t});\r\n\t\tif ($(obj).is('tr'))\r\n\t\t{\r\n\t\t\t$(obj).on('click', '*', function(e){\r\n\t\t\t\tif ($(e.target).is('a,button,:checkbox')) return;\r\n\t\t\t\t\r\n\t\t\t\t$('td:eq(0) :checkbox', $(this).closest('tr')).trigger('click');\r\n\t\t\t});\r\n\t\t\t$('td:eq(0) :checkbox', obj).on('click', function(e){\r\n\t\t\t\tvar $tr = $(this).closest('tr');\r\n\t\t\t\tif (this.checked) $tr.addClass('active'); else $tr.removeClass('active');\r\n\t\t\t});\r\n\t\t}\r\n\t\t\t\r\n\t};\r\n\r\n\tmethod.getConfig = function()\r\n\t{\r\n\t\tvar configs = ['name', 'namespace', 'queryParams', 'displayStart', 'pageLength'];\r\n\t\tvar r = {};\r\n\t\tfor (var i = 0; i < configs.length; i++)\r\n\t\t\tr[ configs[i] ] = $dt.data( configs[i] ) || null;\r\n\t\tvar config = $.bbq.getState();\r\n\t\tif (config)\r\n\t\t\tr = $.extend(true, {},  r, config);\r\n\t\tr.displayStart = ~~r.displayStart;\r\n\t\tr.pageLength = ~~r.pageLength;\r\n\t\t$dt.data(r); //read from hash and set to table's data\r\n\r\n\t\treturn r;\r\n\t};\r\n\r\n\tmethod.setConfig = function(settings){\r\n\t\tvar config = {\r\n\t\t\tdisplayStart: settings._iDisplayStart,\r\n\t\t\tpageLength: settings._iDisplayLength,\r\n\t\t\tsearch: {search: settings.oPreviousSearch.sSearch},\r\n\t\t\torder: []\r\n\t\t};\r\n\t\tsettings.aLastSort.forEach(function(v){\r\n\t\t\tconfig.order.push([v.col, v.dir]);\r\n\t\t});\r\n\t\t//$dt.data(config); //已经写到hash中了，没必要设置table's data\r\n\t\t$.bbq.pushState(config);\r\n\t\treturn true;\r\n\t};\r\n\r\n\tmethod.getColumns = function(removeIt)\r\n\t{\r\n\t\tvar r = [];\r\n\t\t$('tbody td,tbody th', $dt).each(function(i, v){\r\n\t\t\tvar $t = $(this);\r\n\t\t\tvar render = template.compile($t.html());\r\n\r\n\t\t\tvar c = {\r\n\t\t\t\tdata: $t.data('from') || null,\r\n\t\t\t\torderable: $t.data('orderable') !== false,\r\n\t\t\t\tcellType: this.tagName.toLowerCase(),\r\n\t\t\t\tclassName: this.className,\r\n\t\t\t\tcontentPadding: $t.data('contentPadding') || null,\r\n\t\t\t\tdefaultContent: $t.data('defaultContent') || null,\r\n\t\t\t\tname: this.name || null,\r\n\t\t\t\torderData: $t.data('orderData'),\r\n\t\t\t\torderDataType: $t.data('orderDataType') || null,\r\n\t\t\t\torderSequence: $t.data('orderSequence') || [ 'asc', 'desc' ],\r\n\t\t\t\trender: function(data, type, full) {\r\n\t\t\t\t\tvar d = {data: data, type: type, full: full};\r\n\t\t\t\t\treturn render(d);\r\n\t\t\t\t},\r\n\t\t\t\tsearchable: $t.data('searchable') !== false,\r\n\t\t\t\t//type: $t.data('type') || null,\r\n\t\t\t\tvisible: $t.data('visible') !== false,\r\n\t\t\t\t//width: $t.data('width') || null\r\n\t\t\t};\r\n\t\t\tr.push(c);\r\n\t\t});\r\n\t\tif (removeIt === true) $('tbody', $dt).empty();\r\n\t\treturn r;\r\n\t};\r\n\t$.fn.dataTable.ext.renderer.pageButton.bootstrap = function ( settings, host, idx, buttons, page, pages ) {\r\n\t\tvar api     = new $.fn.dataTable.Api( settings );\r\n\t\tvar classes = settings.oClasses;\r\n\t\tvar lang    = settings.oLanguage.oPaginate;\r\n\t\tvar aria = settings.oLanguage.oAria.paginate || {};\r\n\t\tvar btnDisplay, btnClass, counter=0;\r\n\r\n\t\tvar attach = function( container, buttons ) {\r\n\t\t\tvar i, ien, node, button;\r\n\t\t\tvar clickHandler = function ( e ) {\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tif ( !$(e.currentTarget).hasClass('disabled') && api.page() != e.data.action ) {\r\n\t\t\t\t\tapi.page( e.data.action ).draw( 'page' );\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tfor ( i=0, ien=buttons.length ; i<ien ; i++ ) {\r\n\t\t\t\tbutton = buttons[i];\r\n\r\n\t\t\t\tif ( $.isArray( button ) ) {\r\n\t\t\t\t\tattach( container, button );\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tbtnDisplay = '';\r\n\t\t\t\t\tbtnClass = '';\r\n\r\n\t\t\t\t\tswitch ( button ) {\r\n\t\t\t\t\t\tcase 'ellipsis':\r\n\t\t\t\t\t\t\tbtnDisplay = '&#x2026;';\r\n\t\t\t\t\t\t\tbtnClass = 'disabled';\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'first':\r\n\t\t\t\t\t\t\tbtnDisplay = lang.sFirst;\r\n\t\t\t\t\t\t\tbtnClass = button + (page > 0 ?\r\n\t\t\t\t\t\t\t\t'' : ' disabled');\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'previous':\r\n\t\t\t\t\t\t\tbtnDisplay = lang.sPrevious;\r\n\t\t\t\t\t\t\tbtnClass = button + (page > 0 ?\r\n\t\t\t\t\t\t\t\t'' : ' disabled');\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'next':\r\n\t\t\t\t\t\t\tbtnDisplay = lang.sNext;\r\n\t\t\t\t\t\t\tbtnClass = button + (page < pages-1 ?\r\n\t\t\t\t\t\t\t\t'' : ' disabled');\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tcase 'last':\r\n\t\t\t\t\t\t\tbtnDisplay = lang.sLast;\r\n\t\t\t\t\t\t\tbtnClass = button + (page < pages-1 ?\r\n\t\t\t\t\t\t\t\t'' : ' disabled');\r\n\t\t\t\t\t\t\tbreak;\r\n\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\tbtnDisplay = button + 1;\r\n\t\t\t\t\t\t\tbtnClass = page === button ?\r\n\t\t\t\t\t\t\t\t'active' : '';\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ( btnDisplay ) {\r\n\t\t\t\t\t\tnode = $('<li>', {\r\n\t\t\t\t\t\t\t\t'class': classes.sPageButton+' '+btnClass,\r\n\t\t\t\t\t\t\t\t'id': idx === 0 && typeof button === 'string' ?\r\n\t\t\t\t\t\t\t\t\tsettings.sTableId +'_'+ button :\r\n\t\t\t\t\t\t\t\t\tnull\r\n\t\t\t\t\t\t\t} )\r\n\t\t\t\t\t\t\t.append( $('<a>', {\r\n\t\t\t\t\t\t\t\t\t'href': '#',\r\n\t\t\t\t\t\t\t\t\t'aria-controls': settings.sTableId,\r\n\t\t\t\t\t\t\t\t\t'aria-label': aria[ button ],\r\n\t\t\t\t\t\t\t\t\t'data-dt-idx': counter,\r\n\t\t\t\t\t\t\t\t\t'tabindex': settings.iTabIndex\r\n\t\t\t\t\t\t\t\t} )\r\n\t\t\t\t\t\t\t\t.html( btnDisplay )\r\n\t\t\t\t\t\t\t)\r\n\t\t\t\t\t\t\t.appendTo( container );\r\n\r\n\t\t\t\t\t\tsettings.oApi._fnBindAction(\r\n\t\t\t\t\t\t\tnode, {action: button}, clickHandler\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tcounter++;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\t// IE9 throws an 'unknown error' if document.activeElement is used\r\n\t\t// inside an iframe or frame. \r\n\t\tvar activeEl;\r\n\r\n\t\ttry {\r\n\t\t\t// Because this approach is destroying and recreating the paging\r\n\t\t\t// elements, focus is lost on the select button which is bad for\r\n\t\t\t// accessibility. So we want to restore focus once the draw has\r\n\t\t\t// completed\r\n\t\t\tactiveEl = $(host).find(document.activeElement).data('dt-idx');\r\n\t\t}\r\n\t\tcatch (e) {}\r\n\r\n\t\tattach(\r\n\t\t\t$('ul', $(host).empty().html('<div class=\"col-sm-10 col-xs-12\"><ul class=\"pagination pull-right\"/></div>')),\r\n\t\t\tbuttons\r\n\t\t);\r\n\t\t/*添加跳页功能*/\r\n\t\tvar inputPageJump = $('<input>', {\r\n\t\t\tclass: 'form-control',\r\n\t\t\ttype: \"number\",\r\n\t\t\tmin: 1,\r\n\t\t\tmax: pages\r\n\t\t}).val(page+1).on(\"keyup\", function(event){\r\n\t\t\tif (event.keyCode == 13) {\r\n\t\t\t\tvar curr = this.value.replace(/\\s|\\D/g, '') | 0;\r\n\t\t\t\tif (curr) {\r\n\t\t\t\t\tvar pages = api.page.info().pages;\r\n\t\t\t\t\tcurr = curr > pages ? pages : curr;\r\n\t\t\t\t\tcurr--;\r\n\t\t\t\t\tapi.page(curr).draw(false);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t\tvar btnPageJump = $('<span />', {\r\n\t\t\t'class': \"input-group-addon\",\r\n\t\t\t'aria-controls': settings.sTableId,\r\n\t\t\t'tabindex': settings.iTabIndex\r\n\t\t}).html(lang.jump).on(\"click\",function(){\r\n\t\t\tvar curr = inputPageJump.val().replace(/\\s|\\D/g, '') | 0;\r\n\t\t\tif (curr) {\r\n\t\t\t\tvar pages = api.page.info().pages;\r\n\t\t\t\tcurr = curr > pages ? pages : curr;\r\n\t\t\t\tcurr--;\r\n\t\t\t\tapi.page(curr).draw(false);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t$(host).append($('<div />', {\r\n\t\t\t'class' : \"col-sm-2 pull-right input-group hidden-xs\"\r\n\t\t}).append(inputPageJump).append(btnPageJump));\r\n\r\n\t\tif ( activeEl ) {\r\n\t\t\t$(host).find( '[data-dt-idx='+activeEl+']' ).focus();\r\n\t\t}\r\n\t};\r\n\r\n\t$.extend($.fn.dataTable.ext.classes, {\r\n\t\tsWrapper: 'dataTables_wrapper form-inline',\r\n\t\tsFilterInput: 'form-control',\r\n\t\tsLengthSelect: 'form-control',\r\n\t\tsProcessing: 'dataTables_processing',\r\n\t});\r\n\t\r\n\tmethod.make = function(){\r\n\t\tvar config = method.getConfig();\r\n\t\tvar columns = method.getColumns(true);\r\n\t\tmethod.datatable = $dt.DataTable({\r\n\t\t\tdom: \"r\" +\r\n\t\t\t\t\"<'row'<'#toolbar.col-sm-8 text-left'><'col-sm-4 search-filter text-right'f><'clearfix'>>\" +\r\n\t\t\t\t\"<'row'<'col-sm-4 hidden-xs'l><'col-sm-8 col-xs-12'p><'clearfix'>>\" +\r\n\t\t\t\t\"t\" +\r\n\t\t\t\t\"<'row'<'col-sm-4 hidden-xs'i><'col-sm-8 col-xs-12'p><'clearfix'>>\",\r\n\t\t\tlanguage: {\r\n\t\t\t\tlengthMenu: '_MENU_',\r\n\t\t\t\tzeroRecords: '没有记录',\r\n\t\t\t\tsearch: '<div class=\"input-group\">_INPUT_<span class=\"input-group-addon\"><i class=\"fa fa-search\"></i></span></div>',\r\n\t\t\t\tinfo: '<b>_START_</b>-<b>_END_</b> of <b>_TOTAL_</b>',\r\n\t\t\t\tinfoEmpty: '<b>0</b>-<b>0</b> of <b>0</b>',\r\n\t\t\t\tinfoFiltered: '(from <b>_MAX_</b>)',\r\n\t\t\t\tsearchPlaceholder: '输入关键字',\r\n\t\t\t\tpaginate: {\r\n\t\t\t\t\tprevious: '<i class=\"fa fa-backward\"></i>',\r\n\t\t\t\t\tnext: '<i class=\"fa fa-forward\"></i>',\r\n\t\t\t\t\tfirst: '<i class=\"fa fa-step-backward\"></i>',\r\n\t\t\t\t\tlast: '<i class=\"fa fa-step-forward\"></i>',\r\n\t\t\t\t\tjump: '<i class=\"fa fa-paper-plane-o\"></i>'\r\n\t\t\t\t},\r\n\t\t\t\taria: {\r\n\t\t\t\t\tpaginate: {\r\n\t\t\t\t\t\tfirst: '首页',\r\n\t\t\t\t\t\tprevious: '上页',\r\n\t\t\t\t\t\tnext: '下页',\r\n\t\t\t\t\t\tlast: '尾页'\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tprocessing: '<div class=\"mask\"></div><div class=\"inner\"><h3 class=\"text-light\"><b>Loading...</b></h3><div class=\"preloader-spinner fa-spin\"></div></div>'\r\n\t\t\t},\r\n\t\t\tcolumn: {\r\n\t\t\t\tasSorting: [ 'desc', 'asc' ]  //first sort desc, then asc\r\n\t\t\t},\r\n\t\t\trenderer: 'bootstrap',\r\n\r\n\t\t\tajax: {\r\n\t\t\t\turl: $.baseuri + config.namespace+'/'+config.name+'/data/json',\r\n\t\t\t\ttimeout: 20 * 1000,\r\n\t\t\t\ttype: 'POST',\r\n\t\t\t\tdata: function(d){\r\n\t\t\t\t\tvar o = {};\r\n\t\t\t\t\tfor(var i = 0; i < d.order.length; ++i)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tvar item = d.order[i];\r\n\t\t\t\t\t\tif (typeof d.columns[item.column] != 'undefined' && !!d.columns[item.column].orderable)\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar name = !!d.columns[item.column].name ? d.columns[item.column].name : d.columns[item.column].data;\r\n\t\t\t\t\t\t\tif (name) o[name] = item.dir;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tvar query = $.extend(true, {}, config.queryParams, {\r\n\t\t\t\t\t\tq: $.extend(true, d.search.value ? {_all: d.search.value} : {}, window.location.query('q')),\r\n\t\t\t\t\t\to: o,\r\n\t\t\t\t\t\tf: $.extend(true, {}, window.location.query('f'))\r\n\t\t\t\t\t});\r\n\t\t\t\t\t$dt.data('url-query', query);\r\n\t\t\t\t\t//修改导出按钮的链接\r\n\t\t\t\t\t$('a[data-append-queries]').each(function(){$(this).attr('href', $(this).data('href'));}).querystring(query);\r\n\t\t\t\t\treturn $.extend(true, {}, {\r\n\t\t\t\t\t\tsize: d.length,\r\n\t\t\t\t\t\tpage: !isNaN(d.start / d.length) ? Math.ceil(d.start / d.length) : 1\r\n\t\t\t\t\t}, query);\r\n\t\t\t\t},\r\n\t\t\t\tdataSrc: function(json){\r\n\t\t\t\t\tif (json && json.result == 'success' || json.result == 'api') {\r\n\t\t\t\t\t\tjson.recordsTotal = json.data.recordsTotal;\r\n\t\t\t\t\t\tjson.recordsFiltered = json.data.recordsFiltered;\r\n\t\t\t\t\t\tjson.data.data.forEach(function(v, k){v.DT_RowId = 'line-' + (v.id ? v.id : k);});\r\n\t\t\t\t\t\treturn json.data.data;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t else \r\n\t\t\t\t\t\t$.showtips(json);\r\n\t\t\t\t\treturn [];\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tserverSide: true,\r\n\t\t\tdeferRender: true,\r\n\t\t\tcolumns: columns,\r\n\t\t\trowCallback: function( row, data, dataIndex ) {\r\n\t\t\t\t//call\r\n\t\t\t},\r\n\t\t\tcreatedRow: function( row, data, dataIndex ) {\r\n\t\t\t\t// Initialize Tooltips\r\n\t\t\t\tif ($.fn.tooltip) $('[data-toggle=\"tooltip\"], .enable-tooltip', row).tooltip({container: 'body', animation: false});\r\n\t\t\t\t// Initialize Popovers\r\n\t\t\t\tif ($.fn.popover) $('[data-toggle=\"popover\"], .enable-popover', row).popover({container: 'body', animation: true});\t\t\r\n\t\t\t\t//call\t\r\n\t\t\t\tmethod.bindMethods(row);\r\n\t\t\t},\r\n\t\t\tdrawCallback: function( settings ) {\r\n\t\t\t\tmethod.setConfig(settings);\r\n\t\t\t\t//call\r\n\t\t\t}/*,\r\n\t\t\tstateSave: false,\r\n\t\t\tstateDuration: -1*/\r\n\t\t});\r\n\t};\r\n\r\n\t//初始化\r\n\tmethod.bindMethods('body');\r\n\tmethod.make();\r\n\r\n\t$('#tools-contrainer').appendTo('#toolbar');\r\n\t$('#reload').on('click', function(){\r\n\t\tmethod.datatable.ajax.reload(null, false);\r\n\t});\r\n\t/* Select/Deselect all checkboxes in tables */\r\n\t$('thead th:eq(0) :checkbox', '.table').on('click', function(e) {\r\n\r\n\t\tvar checkedStatus   = $(this).prop('checked');\r\n\t\tvar table           = $(this).closest('table');\r\n\t\te.stopPropagation();\r\n\t\t//e.preventDefault();\r\n\t\t$('tbody :checkbox:visible', $dt).each(function() {\r\n\r\n\t\t\t$(this).prop('checked', checkedStatus).triggerHandler('click');\r\n\t\t});\r\n\r\n\t});\r\n});\r\n\t\r\n})(jQuery);"]}