!function(e){function i(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,i),a.l=!0,a.exports}var t={};i.m=e,i.c=t,i.i=function(e){return e},i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,i){return Object.prototype.hasOwnProperty.call(e,i)},i.p="./",i(i.s=8)}({0:function(e,i,t){"use strict";var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};window.UPLOADER_LANGUAGE={close:"\u5173\u95ed",select_file:"\u9009\u62e9\u6587\u4ef6",ctrl_v_tip:"\u53ef\u4ee5\u4f7f\u7528Ctrl+V\u76f4\u63a5\u7c98\u8d34\u622a\u56fe\uff08\u9700\u73b0\u4ee3\u6d4f\u89c8\u5668\uff09",ctrl_v_button:"Ctrl+V \u7c98\u8d34",resize:"\u56fe\u7247\u4f1a\u81ea\u52a8\u7b49\u6bd4\u7f29\u653e\u81f3\uff1a{{0}} (\u4ec5jpg)",uploading:"\u6b63\u5728\u4e0a\u4f20\u6587\u4ef6...",success:"\u4e0a\u4f20\u6210\u529f!",rotate_right:"\u5411\u53f3\u65cb\u8f6c",rotate_left:"\u5411\u5de6\u65cb\u8f6c",loading:"\u6b63\u5728\u8f7d\u5165...",reading:"\u6587\u4ef6\u8bfb\u53d6\u4e2d...",filetype:"\u8bf7\u4e0a\u4f20{{0}}\u6587\u4ef6!",filenum_limite:"\u53ea\u5141\u8bb8\u4e0a\u4f20{{0}}\u4e2a\u6587\u4ef6\uff0c\u8bf7\u5220\u51cf\u540e\u91cd\u8bd5!",hashing:"\u6b63\u5728\u6548\u9a8c\u6587\u4ef6...",hash_success:"\u4e91\u7aef\u6587\u4ef6\u5df2\u5b58\u5728\uff0c\u6587\u4ef6\u79d2\u4f20\u6210\u529f!",error:"\u9519\u8bef",num_limit:"\u53ea\u80fd\u4e0a\u4f20{{0}}\u4e2a\u6587\u4ef6!",allsize_limit:"\u6587\u4ef6\u603b\u5927\u5c0f\u8d85\u51fa\u9650\u5236!",filesize_limite:"\u6587\u4ef6\u5927\u5c0f\u8d85\u51fa {{0}}!",duplicate:"\u4e0a\u4f20\u961f\u5217\u4e2d\u6709\u91cd\u590d\u6587\u4ef6!"},function(e){if("undefined"==typeof LP)throw"this javascript file need behind 'laravel.lp.js'";e.fn.extend({uploader:function(i,t,a,s,l,o){var n={max_width:0,max_height:0,filesize:2097152,filetype:"jpg,jpeg,png,bmp,gif,webp,svg",filelimit:1,id:null};"object"==(void 0===i?"undefined":r(i))&&null!==i?n=e.extend({},n,i):!0!==i&&(void 0!==i&&(n.max_width=parseFloat(i)),void 0!==t&&(n.max_height=parseFloat(t)),void 0!==a&&(n.filesize=parseFloat(a)),void 0!==s&&(n.filetype=s.toLowerCase()),void 0!==l&&(n.filelimit=parseInt(l)),void 0!==o&&(n.id=o));var d=["jpg","jpeg","png","bmp","gif","webp","svg"];return this.each(function(){var t=e(this),r=t.prop("flex_uploader")?t.prop("flex_uploader"):{};if(r&&r.uploader&&(delete r.uploader,r.$container.remove(),t.removeProp("flex_uploader")),!0!==i){var a={interval:null},s=function(){return rand(1e4,99999)}(),l="uploader-id-"+s,o="pick-id-"+s,u=l+"-progresses",p=l+"-thumbnails";r.$container=e('<div class="uploader-container" id="'+l+'"><div class="pull-left"><div id="'+o+'">'+UPLOADER_LANGUAGE.select_file+"(\u2264 "+bytesToSize(n.filesize)+')</div></div><div class="pull-left tags">&nbsp;<span class="label label-success">.'+n.filetype.replace(/,/g,'</span>&nbsp;<span class="label label-success">.')+'</span>&nbsp;<span class="label label-warning enable-tooltip" data-placement="top" title="'+UPLOADER_LANGUAGE.drop_container+'">'+(n.max_width>0&&n.max_height>0?"<br /><small>&nbsp;"+UPLOADER_LANGUAGE.resize.replace("{{0}}",n.max_width.toString().toHTML()+"x"+n.max_height.toString().toHTML())+"</small>":"")+'</div><div class="clearfix"></div><div id="'+u+'" class="progresses"></div><div class="clearfix"></div><div id="'+p+'" class="thumbnails row"></div><div class="clearfix"></div></div>').insertAfter(t),void 0!==e.fn.tooltip&&e(".enable-tooltip",r.$container).tooltip();var c={},f=function i(t){return c[t.id]||(c[t.id]=e('<div class="media alert alert-warning fade in"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button><div class="media-left media-middle"><img class="media-object" src="" alt=""></div><div class="media-body"><h4 class="media-heading">'+t.name.toHTML()+"("+bytesToSize(t.size)+')</h4><div class="media-message"></div><div class="progress"><div class="progress-bar progress-bar-warning progress-bar-striped active" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%"><span class=""></span></div></div></div></div>').appendTo("#"+u).on("closed.bs.alert",function(){"complete"==t.getStatus()?i(t).remove():i(t).cancel()})),{init:function(){return c[t.id].removeClass("alert-info alert-danger alert-success alert-warning"),this},initProgress:function(){e(".progress-bar",c[t.id]).removeClass("progress-bar-info progress-bar-danger progress-bar-success progress-bar-warning")},thumb:function(){r.uploader.makeThumb(t,function(i,r){e(".media-object",c[t.id]).attr("src",i?LP.baseuri+"placeholder?text="+t.ext+"&size=75x75&fontsize=35":r)})},name:function(i){return e(".progressName",c[t.id]).html(i.toHTML()),this},message:function(i){return e(".media-message",c[t.id]).html(i),this},error:function(i){return this.init(),this.initProgress(),t.setStatus("invalid"),c[t.id].addClass("alert-danger"),e(".progress-bar",c[t.id]).addClass("progress-bar-danger"),this.message(i)},progressing:function(i,r){this.init(),this.initProgress(),c[t.id].addClass("alert-info"),i=i.toFixed(2);var a=e(".progress-bar",c[t.id]).width(i+"%");return e(".progress-bar span",c[t.id]).text(i+"%"),i<20?a.addClass("progress-bar-warning"):i<95?a.addClass("progress-bar-info"):a.addClass("progress-bar-success"),i<100?a.addClass("active"):a.removeClass("active"),this.message(UPLOADER_LANGUAGE.uploading)},success:function(){return this.progressing(100),this.init(),c[t.id].addClass("alert-success"),c[t.id].delay(1500).queue(function(){e(this).alert("close").dequeue()}),this.message(UPLOADER_LANGUAGE.success)},cancel:function(){return r.uploader.cancelFile(t),this.remove()},remove:function(){return c[t.id].remove(),delete c[t.id],this}}},g={},m=function i(a,s,l){if(void 0!==a&&void 0===g[a])if(g[a]=e('<div class="col-xs-6 col-md-4 alert"><div class="thumbnail"><div class="file-panel"><span class="cancel" data-dismiss="alert" aria-label="Close">'+UPLOADER_LANGUAGE.close+'</span><span class="rotateRight">'+UPLOADER_LANGUAGE.rotate_right+'</span><span class="rotateLeft">'+UPLOADER_LANGUAGE.rotate_left+'</span></div><a href="'+LP.baseuri+"attachment/"+a+'"  target="_blank"><img src="'+LP.baseuri+"placeholder?size=300x200&text="+encodeURIComponent(UPLOADER_LANGUAGE.loading)+'" alt="" class="img-responsive center-block"  onerror="this.src=\''+LP.baseuri+"placeholder?size=300x200&text='+encodeURIComponent('"+UPLOADER_LANGUAGE.reading+'\');"></a><div class="caption"><h4><span class="title">'+(s?s.toHTML():"")+'</span><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></h4></div><div class="clearfix"></div></div><div class="clearfix"></div></div>').appendTo("#"+p).on("closed.bs.alert",function(){i(a).remove()}),e(".rotateLeft,.rotateRight",g[a]).on("click",function(){var i=parseInt(g[a].data("rotation"))||0;i+=e(this).is(".rotateLeft")?-90:90,deg="rotate("+i+"deg)",e("img",g[a]).css(e.supportTransition?{"-webkit-transform":deg,"-mos-transform":deg,"-o-transform":deg,transform:deg}:{filter:"progid:DXImageTransform.Microsoft.BasicImage(rotation="+~~(i/90%4+4)%4+")"}),g[a].data("rotation",i)}),l){var o=d.indexOf(l.toLowerCase())>-1?LP.baseuri+"attachment/preview/"+a:LP.baseuri+"placeholder?size=300x200&text="+encodeURIComponent(l);e("img",g[a]).attr("src",o)}else LP.get(LP.baseuri+"api/attachment/"+a).done(function(i){if(void 0!==i.data.ext){var t=d.indexOf(i.data.ext.toLowerCase())>-1?LP.baseuri+"attachment/preview/"+a:LP.baseuri+"placeholder?size=300x200&text="+encodeURIComponent(i.data.ext);e(".title",g[a]).text(i.data.filename),e("img",g[a]).attr("src",t)}});return{build:function(){return!1===t.triggerHandler("uploader.previewing",[this.getFile(),a,h().get()])?this:(h().add(a),t.triggerHandler("uploader.previewed",[this.getFile(),a,h().get()]),this)},remove:function(){var e=this.getFile();return!1===t.triggerHandler("uploader.removing",[e,a,h().get()])?this:(e&&r.uploader.removeFile(e,!0),h().remove(a),g[a].remove(),delete g[a],t.triggerHandler("uploader.removed",[e,a,h().get()]),this)},setFile:function(e){return g[a].data("file",e),this},getFile:function(){return g[a].data("file")},removeAll:function(){for(var e in g)i(e).remove()},rebuildAll:function(){files=r.uploader.getFiles();for(var e=0;e<files.length;e++)r.uploader.removeFile(files[e],!0);this.removeAll();var t=h().get();for(e=0;e<t.length;e++)i(t[e]).build();return this}}},h=function(){var e=t.val();return"0"==e&&(e=""),aids=e?e instanceof Array?e:e.split(","):[],{write:function(){return t.is("select")&&(t.empty(),aids.forEach(function(e){t.append('<option value="'+e+'">'+e+"</option>")})),t.val(aids),this},add:function(e){return 1==n.filelimit&&(aids=[e.toString()]),-1==aids.indexOf(e.toString())&&aids.push(e.toString()),this.write()},remove:function(e){var i=aids.indexOf(e.toString());return-1!=i&&aids.splice(i,1),this.write()},removeAll:function(){return aids=[],this.write()},get:function(){return aids}}};a.beforeFileQueued=function(i){return-1==n.filetype.split(",").indexOf(i.ext.toLowerCase())?(e.alert(UPLOADER_LANGUAGE.filetype.replace("{{0}}",n.filetype)),!1):!(n.filelimit>1&&h().get().length>=n.filelimit)||(e.alert(UPLOADER_LANGUAGE.filenum_limite.replace("{{0}}",n.filelimit)),!1)},a.fileQueued=function(e){return!1!==t.triggerHandler("uploader.uploading",[e,h().get()])&&(f(e).init().thumb(),n.max_width>0&&n.max_height>0&&("jpg"==e.ext||"jpeg"==e.ext)?(r.uploader.upload(e),!0):(this.md5File(e).progress(function(i){f(e).progressing(0).message(UPLOADER_LANGUAGE.hashing+" "+(100*i).toFixed(2)+"%")}).then(function(i){LP.PUT(LP.baseuri+"attachment/hash",{hash:i,_token:LP.csrf,filename:e.name,ext:e.ext,size:e.size}).done(function(i){r.uploader.skipFile(e),f(e).success().message(UPLOADER_LANGUAGE.hash_success),1==n.filelimit&&m().removeAll(),m(i.data.id,i.data.filename,i.data.ext).build().setFile(e),t.triggerHandler("uploader.uploaded",[e,i,h().get()])}).fail(function(){e.md5=i,r.uploader.upload(e)})}),!0))},a.uploadBeforeSend=function(e,i,t){i.uuid=e.blob.ruid+e.file.id+e.file.size,i.start=e.start,i.end=e.end,i.chunks=e.chunks,i.chunk=e.chunk,i.total=e.file.size,i.hash=e.file.md5},a.uploadStart=function(e){},a.uploadProgress=function(e,i){t.triggerHandler("uploader.progressing",[e,100*i,h().get()]),f(e).progressing(100*i)},a.uploadSuccess=function(e,i){var r=i.message&&i.message.content?i.message.content:i.message;!i||"success"!=i.result&&"api"!=i.result?(f(e).error(UPLOADER_LANGUAGE.error+": "+r),t.triggerHandler("uploader.error",[e,r,h().get()])):(f(e).success(),1==n.filelimit&&m().removeAll(),m(i.data.id,i.data.filename,i.data.ext).build().setFile(e),t.triggerHandler("uploader.uploaded",[e,i,h().get()]))},a.uploadError=function(e,i){f(e).error(UPLOADER_LANGUAGE.error+": "+i),t.triggerHandler("uploader.error",[e,i,h().get()])},a.uploadComplete=function(e){},a.error=function(i,t,r){switch(i){case"Q_EXCEED_NUM_LIMIT":e.alert(UPLOADER_LANGUAGE.num_limit.replace("{{0}}",t));break;case"Q_EXCEED_SIZE_LIMIT":e.alert(UPLOADER_LANGUAGE.allsize_limit);break;case"F_EXCEED_SIZE":e.alert(UPLOADER_LANGUAGE.filesize_limite.replace("{{0}}",bytesToSize(n.filesize)));break;case"F_DUPLICATE":e.alert(UPLOADER_LANGUAGE.duplicate);break;case"Q_TYPE_DENIED":e.alert(UPLOADER_LANGUAGE.filetype.replace("{{0}}",n.filetype));break;default:e.alert(i)}},a.create=function(){r.uploader||void 0===t.prop("flex_uploader")||void 0!==t.prop("flex_uploader").uploader||(r.uploader=WebUploader.create({swf:LP.baseuri+"static/js/webuploader/Uploader.swf",server:LP.baseuri+"attachment/uploader?of=json",pick:{id:document.getElementById(o),multiple:!0},formData:e.extend(!0,{},{_token:LP.csrf}),fileVal:"Filedata",method:"POST",sendAsBinary:!1,fileNumLimit:0,fileSingleSizeLimit:n.filesize,duplicate:!1,accept:{title:UPLOADER_LANGUAGE.select_file,extensions:n.filetype,mimeTypes:"undefined"==typeof mimeType||navigator.userAgent.indexOf("Chrome")?"*/*":n.filetype.split(",").map(function(e){return mimeType.lookup("name."+e)}).join(",")},prepareNextFile:!0,chunkSize:5242880,chunkRetry:5,chunked:!0,threads:3,thumb:{width:75,height:75,quality:70,allowMagnify:!1,crop:!0},resize:!1,compress:null}),n.max_width>0&&n.max_height>0&&r.uploader.option("compress",{width:n.max_width,height:n.max_height,quality:100,allowMagnify:!1,crop:!1,preserveHeaders:!0,noCompressIfLarger:!0,compressSize:0}),r.uploader.on("beforeFileQueued",a.beforeFileQueued),r.uploader.on("fileQueued",a.fileQueued),r.uploader.on("uploadBeforeSend",a.uploadBeforeSend),r.uploader.on("uploadStart",a.uploadStart),r.uploader.on("uploadProgress",a.uploadProgress),r.uploader.on("uploadSuccess",a.uploadSuccess),r.uploader.on("uploadError",a.uploadError),r.uploader.on("uploadComplete",a.uploadComplete),r.uploader.on("error",a.error),t.prop("flex_uploader",r),n.id&&h().add(n.id),m().rebuildAll())},t.prop("flex_uploader",r),r.$container.is(":visible")?a.create():a.interval=setInterval(function(){r.$container.is(":visible")&&(clearInterval(a.interval),a.create())},500)}})}})}(jQuery)},8:function(e,i,t){e.exports=t(0)}});