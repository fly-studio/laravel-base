{"version":3,"sources":["jquery.uploader.js"],"names":["UPLOADER_LANGUAGE","close","drop_container","drop_tip","drop_button","select_file","ctrl_v_tip","ctrl_v_button","resize","uploading","success","rotate_right","rotate_left","loading","reading","filetype","filenum_limite","hashing","hash_success","error","num_limit","allsize_limit","filesize_limite","duplicate","$","LP","fn","extend","uploader","max_width","max_height","filesize","filelimit","id","options","parseFloat","toLowerCase","parseInt","img_types","this","each","t","flex_uploader","prop","$container","remove","removeProp","method","interval","nonce","rand","uploader_id","pick_id","progresses_id","thumbnails_id","bytesToSize","replace","toString","toHTML","insertAfter","tooltip","$progresses","progress","file","name","size","appendTo","on","getStatus","cancel","init","removeClass","initProgress","thumb","makeThumb","ret","attr","baseuri","ext","html","message","setStatus","addClass","progressing","percentage","is_hashing","toFixed","$bar","width","text","delay","queue","alert","dequeue","cancelFile","$thumbnails","preview","filename","fileext","encodeURIComponent","rotation","data","is","deg","css","supportTransition","-webkit-transform","-mos-transform","-o-transform","transform","filter","pic","indexOf","get","done","json","build","triggerHandler","getFile","attachment","add","removeFile","setFile","removeAll","rebuildAll","files","getFiles","i","length","aids","aid","val","Array","split","write","empty","forEach","append","push","splice","beforeFileQueued","fileQueued","upload","md5File","then","PUT","hash","_token","csrf","skipFile","fail","md5","uploadBeforeSend","obj","headers","uuid","blob","ruid","start","end","chunks","chunk","total","uploadStart","uploadProgress","uploadSuccess","content","result","uploadError","reason","uploadComplete","code","max","create","WebUploader","swf","server","pick","document","getElementById","multiple","formData","fileVal","sendAsBinary","fileNumLimit","fileSingleSizeLimit","accept","title","extensions","mimeTypes","mimeType","navigator","userAgent","map","v","lookup","join","prepareNextFile","chunkSize","chunkRetry","chunked","threads","height","quality","allowMagnify","crop","compress","option","preserveHeaders","noCompressIfLarger","compressSize","setInterval","clearInterval","jQuery"],"mappings":"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","file":"jquery.uploader.min.js","sourcesContent":["var UPLOADER_LANGUAGE = {\r\n\t'close' : '关闭',\r\n\t'drop_container' : '拖到文件到这里',\r\n\t'drop_tip' : '支持从Windows中拖动文件到这里上传（需现代浏览器）',\r\n\t'drop_button' : '拖放文件',\r\n\t'select_file' : '选择文件',\r\n\t'ctrl_v_tip' : '可以使用Ctrl+V直接粘贴截图（需现代浏览器）',\r\n\t'ctrl_v_button' : 'Ctrl+V 粘贴',\r\n\t'resize' : '图片会自动等比缩放至：{{0}} (仅jpg)',\r\n\t'uploading' : '正在上传文件...',\r\n\t'success' : '上传成功!',\r\n\t'rotate_right' : '向右旋转',\r\n\t'rotate_left' : '向左旋转',\r\n\t'loading' : '正在载入...',\r\n\t'reading' : '文件读取中...',\r\n\t'filetype' : '请上传{{0}}文件!',\r\n\t'filenum_limite' : '只允许上传{{0}}个文件，请删减后重试!',\r\n\t'hashing' : '正在效验文件...',\r\n\t'hash_success' : '云端文件已存在，文件秒传成功!',\r\n\t'error' : '错误',\r\n\t'num_limit' : '只能上传{{0}}个文件!',\r\n\t'allsize_limit' : '文件总大小超出限制!',\r\n\t'filesize_limite'  : '文件大小超出 {{0}}!',\r\n\t'duplicate' : '上传队列中有重复文件!'\r\n};\r\n(function($){\r\n\tif(typeof LP == 'undefined')\r\n\t\tthrow('this javascript file need behind \\'laravel.lp.js\\'');\r\n\t\r\n\t$.fn.extend({\r\n\t\tuploader : function(max_width, max_height, filesize, filetype, filelimit, id) {\r\n\t\t\tvar options = {\r\n\t\t\t\tmax_width: 0,\r\n\t\t\t\tmax_height: 0,\r\n\t\t\t\tfilesize: 2 * 1024 * 1024,\r\n\t\t\t\tfiletype: 'jpg,jpeg,png,bmp,gif,webp,svg',\r\n\t\t\t\tfilelimit: 1,\r\n\t\t\t\tid: null,\r\n\t\t\t};\r\n\t\t\tif (typeof max_width == 'object' && max_width !== null) // it's options\r\n\t\t\t\toptions = $.extend({}, options, max_width);\r\n\t\t\telse if (max_width !== true)\r\n\t\t\t{\r\n\t\t\t\tif (typeof max_width != 'undefined') options.max_width = parseFloat(max_width);\r\n\t\t\t\tif (typeof max_height != 'undefined') options.max_height = parseFloat(max_height);\r\n\t\t\t\tif (typeof filesize != 'undefined') options.filesize = parseFloat(filesize);\r\n\t\t\t\tif (typeof filetype != 'undefined') options.filetype = filetype.toLowerCase();\r\n\t\t\t\tif (typeof filelimit != 'undefined') options.filelimit = parseInt(filelimit);\r\n\t\t\t\tif (typeof id != 'undefined') options.id = id;\r\n\t\t\t}\r\n\t\t\tvar img_types = ['jpg','jpeg','png','bmp','gif','webp','svg'];\r\n\t\t\treturn this.each(function(){\r\n\t\t\t\tvar t = $(this);\r\n\r\n\t\t\t\tvar flex_uploader = t.prop('flex_uploader') ? t.prop('flex_uploader') : {};\r\n\t\t\t\tif (flex_uploader && flex_uploader.uploader)\r\n\t\t\t\t{ //删除原有的控件\r\n\t\t\t\t\tdelete flex_uploader.uploader;\r\n\t\t\t\t\tflex_uploader.$container.remove();\r\n\t\t\t\t\tt.removeProp('flex_uploader');\r\n\t\t\t\t}\r\n\t\t\t\t//删除该控件，下面的不用执行\r\n\t\t\t\tif (max_width === true) return;\r\n\r\n\t\t\t\tvar method = {interval: null};\r\n\t\t\t\tvar nonce = function(){\r\n\t\t\t\t\treturn rand(10000,99999);\r\n\t\t\t\t};\r\n\t\t\t\tvar id = nonce();\r\n\t\t\t\tvar uploader_id = 'uploader-id-' + id, pick_id = 'pick-id-' + id;\r\n\t\t\t\tvar progresses_id = uploader_id + '-progresses', thumbnails_id = uploader_id + '-thumbnails', input_id = uploader_id + '-input';\r\n\t\t\t\t//添加容器到input下\r\n\t\t\t\tflex_uploader.$container = $('<div class=\"uploader-container\" id=\"'+ uploader_id +'\">'+\r\n\t\t\t\t\t'<div class=\"pull-left\"><div id=\"'+ pick_id +'\">'+ UPLOADER_LANGUAGE.select_file +'(≤ '+ bytesToSize(options.filesize) +')</div></div>' +\r\n\t\t\t\t\t'<div class=\"pull-left tags\">&nbsp;<span class=\"label label-success\">.' + options.filetype.replace(/,/g,'</span>&nbsp;<span class=\"label label-success\">.') + '</span>' +\r\n\t\t\t\t\t'&nbsp;<span class=\"label label-warning enable-tooltip\" data-placement=\"top\" title=\"'+ UPLOADER_LANGUAGE.drop_container +'\"><small class=\"glyphicon glyphicon-info-sign\"></small> '+ UPLOADER_LANGUAGE.drop_button +'</span>' +\r\n\t\t\t\t\t(options.max_width > 0 && options.max_height > 0 ? '<br /><small>&nbsp;'+ UPLOADER_LANGUAGE.resize.replace('{{0}}', options.max_width.toString().toHTML() + 'x' + options.max_height.toString().toHTML()) + '</small>' : '') +\r\n\t\t\t\t\t'</div><div class=\"clearfix\"></div>' +\r\n\t\t\t\t\t'<div id=\"' + progresses_id + '\" class=\"progresses\"></div><div class=\"clearfix\"></div>' +\r\n\t\t\t\t\t'<div id=\"' + thumbnails_id + '\" class=\"thumbnails row\"></div><div class=\"clearfix\"></div>' +\r\n\t\t\t\t\t'</div>').insertAfter(t);\r\n\t\t\t\t\r\n\t\t\t\tif (typeof $.fn.tooltip != 'undefined') $('.enable-tooltip', flex_uploader.$container).tooltip();\r\n\r\n\t\t\t\tvar $progresses = {};\r\n\t\t\t\tvar progress = function(file){\r\n\t\t\t\t\tif (!$progresses[file.id])\r\n\t\t\t\t\t\t$progresses[file.id] = $('<div class=\"media alert alert-warning fade in\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>' +\r\n\t\t\t\t\t\t\t'<div class=\"media-left media-middle\"><img class=\"media-object\" src=\"\" alt=\"\"></div>' +\r\n\t\t\t\t\t\t\t'<div class=\"media-body\"><h4 class=\"media-heading\">'+file.name.toHTML()+'('+bytesToSize(file.size)+')</h4>' +\r\n\t\t\t\t\t\t\t'<div class=\"media-message\"></div>' +\r\n\t\t\t\t\t\t\t'<div class=\"progress\">' +\r\n\t\t\t\t\t\t\t\t'<div class=\"progress-bar progress-bar-warning progress-bar-striped active\" role=\"progressbar\" aria-valuenow=\"0\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width: 0%\">' +\r\n\t\t\t\t\t\t\t\t\t'<span class=\"\"></span>' +\r\n\t\t\t\t\t\t\t\t'</div>' +\r\n\t\t\t\t\t\t\t'</div>' +\r\n\t\t\t\t\t\t\t'</div>' +\r\n\t\t\t\t\t\t'</div>').appendTo('#'+progresses_id).on('closed.bs.alert', function(){\r\n\t\t\t\t\t\t\tif (file.getStatus() == 'complete')\r\n\t\t\t\t\t\t\t\tprogress(file).remove();\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\tprogress(file).cancel();\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\t//console.log(file);\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tinit: function(){\r\n\t\t\t\t\t\t\t$progresses[file.id].removeClass('alert-info alert-danger alert-success alert-warning');\r\n\t\t\t\t\t\t\treturn this;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tinitProgress: function(){\r\n\t\t\t\t\t\t\t $('.progress-bar', $progresses[file.id]).removeClass('progress-bar-info progress-bar-danger progress-bar-success progress-bar-warning');\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tthumb: function(){\r\n\t\t\t\t\t\t\tflex_uploader.uploader.makeThumb( file, function( error, ret ) {\r\n\t\t\t\t\t\t\t\t$('.media-object', $progresses[file.id]).attr('src', error ? LP.baseuri+'placeholder?text='+file.ext+'&size=75x75&fontsize=35' : ret);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tname: function(name){\r\n\t\t\t\t\t\t\t$('.progressName', $progresses[file.id]).html(name.toHTML());\r\n\t\t\t\t\t\t\treturn this;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tmessage: function(message){\r\n\t\t\t\t\t\t\t$('.media-message', $progresses[file.id]).html(message);\r\n\t\t\t\t\t\t\treturn this;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\terror: function(message) {\r\n\t\t\t\t\t\t\tthis.init();\r\n\t\t\t\t\t\t\tthis.initProgress();\r\n\t\t\t\t\t\t\tfile.setStatus('invalid');\r\n\t\t\t\t\t\t\t$progresses[file.id].addClass(\"alert-danger\");\r\n\t\t\t\t\t\t\t$('.progress-bar', $progresses[file.id]).addClass(\"progress-bar-danger\");\r\n\t\t\t\t\t\t\treturn this.message(message);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tprogressing: function (percentage, is_hashing) {\r\n\t\t\t\t\t\t\tthis.init();\r\n\t\t\t\t\t\t\tthis.initProgress();\r\n\t\t\t\t\t\t\t$progresses[file.id].addClass(\"alert-info\");\r\n\t\t\t\t\t\t\tpercentage = percentage.toFixed(2);\r\n\t\t\t\t\t\t\tvar $bar = $('.progress-bar', $progresses[file.id]).width(percentage + \"%\");\r\n\t\t\t\t\t\t\t$('.progress-bar span', $progresses[file.id]).text(percentage + \"%\");\r\n\t\t\t\t\t\t\tif (percentage < 20)\r\n\t\t\t\t\t\t\t\t$bar.addClass('progress-bar-warning');\r\n\t\t\t\t\t\t\telse if (percentage < 95)\r\n\t\t\t\t\t\t\t\t$bar.addClass('progress-bar-info');\r\n\t\t\t\t\t\t\telse\r\n\t\t\t\t\t\t\t\t$bar.addClass('progress-bar-success');\r\n\t\t\t\t\t\t\tif (percentage < 100) $bar.addClass('active'); else $bar.removeClass('active');\r\n\t\t\t\t\t\t\treturn this.message(UPLOADER_LANGUAGE.uploading);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsuccess: function() {\r\n\t\t\t\t\t\t\tthis.progressing(100);\r\n\t\t\t\t\t\t\tthis.init();\r\n\t\t\t\t\t\t\t$progresses[file.id].addClass(\"alert-success\");\r\n\r\n\t\t\t\t\t\t\t$progresses[file.id].delay(1500).queue(function(){\r\n\t\t\t\t\t\t\t\t$(this).alert('close').dequeue();\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\treturn this.message(UPLOADER_LANGUAGE.success);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tcancel: function() {\r\n\t\t\t\t\t\t\tflex_uploader.uploader.cancelFile(file);\r\n\t\t\t\t\t\t\treturn this.remove();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tremove: function() {\r\n\t\t\t\t\t\t\t$progresses[file.id].remove();\r\n\t\t\t\t\t\t\tdelete $progresses[file.id];\r\n\t\t\t\t\t\t\treturn this;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t};\r\n\t\t\t\tvar $thumbnails = {};\r\n\t\t\t\tvar preview = function(id, filename, fileext)\r\n\t\t\t\t{\r\n\t\t\t\t\tif (typeof id != 'undefined' && typeof $thumbnails[id] == 'undefined')\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t$thumbnails[id] = $('<div class=\"col-xs-6 col-md-4 alert\"><div class=\"thumbnail\">' +\r\n\t\t\t\t\t\t\t'<div class=\"file-panel\"><span class=\"cancel\" data-dismiss=\"alert\" aria-label=\"Close\">'+UPLOADER_LANGUAGE.close+'</span><span class=\"rotateRight\">'+UPLOADER_LANGUAGE.rotate_right+'</span><span class=\"rotateLeft\">'+UPLOADER_LANGUAGE.rotate_left+'</span></div>' +\r\n\t\t\t\t\t\t\t'<a href=\"'+LP.baseuri+'attachment/'+id+'\"  target=\"_blank\"><img src=\"'+LP.baseuri+'placeholder?size=300x200&text='+encodeURIComponent(UPLOADER_LANGUAGE.loading)+'\" alt=\"\" class=\"img-responsive center-block\"  onerror=\"this.src=\\''+ LP.baseuri +'placeholder?size=300x200&text=\\'+encodeURIComponent(\\''+UPLOADER_LANGUAGE.reading+'\\');\"></a>' +\r\n\t\t\t\t\t\t\t'<div class=\"caption\">' +\r\n        \t\t\t\t\t'<h4><span class=\"title\">'+(filename ? filename.toHTML() : '')+'</span><button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button></h4>' +\r\n\t\t\t\t\t\t\t'</div><div class=\"clearfix\"></div>' +\r\n\t\t\t\t\t\t\t'</div><div class=\"clearfix\"></div></div>').appendTo('#' + thumbnails_id).on('closed.bs.alert', function(){\r\n\t\t\t\t\t\t\t\tpreview(id).remove();\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t$('.rotateLeft,.rotateRight', $thumbnails[id]).on('click', function(){\r\n\t\t\t\t\t\t\t\tvar rotation = parseInt($thumbnails[id].data('rotation')) || 0;\r\n\t\t\t\t\t\t\t\trotation += $(this).is('.rotateLeft') ? -90 : 90;\r\n\t\t\t\t\t\t\t\tdeg = 'rotate(' + rotation + 'deg)';\r\n\t\t\t\t\t\t\t\t$('img', $thumbnails[id]).css(\r\n\t\t\t\t\t\t\t\t\t$.supportTransition ? {'-webkit-transform': deg,'-mos-transform': deg,'-o-transform': deg,'transform': deg}\r\n\t\t\t\t\t\t\t\t     : {filter: 'progid:DXImageTransform.Microsoft.BasicImage(rotation='+ (~~((rotation/90)%4 + 4)%4) +')'}\r\n\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t$thumbnails[id].data('rotation', rotation);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (!fileext) \r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tLP.get(LP.baseuri + 'attachment/info/'+ id).done(function(json){\r\n\t\t\t\t\t\t\t\tif (typeof json.data.ext != 'undefined')\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\tvar pic = img_types.indexOf(json.data.ext.toLowerCase()) > -1 ? LP.baseuri + 'attachment/preview/'+ id : LP.baseuri + 'placeholder?size=300x200&text='+encodeURIComponent(json.data.ext);\r\n\t\t\t\t\t\t\t\t\t$('.title', $thumbnails[id]).text(json.data.filename);\r\n\t\t\t\t\t\t\t\t\t$('img', $thumbnails[id]).attr('src',pic);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tvar pic = img_types.indexOf(fileext.toLowerCase()) > -1 ? LP.baseuri + 'attachment/preview/'+ id: LP.baseuri + 'placeholder?size=300x200&text='+ encodeURIComponent(fileext);\r\n\t\t\t\t\t\t\t$('img', $thumbnails[id]).attr('src',pic);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\tbuild: function(){\r\n\t\t\t\t\t\t\tif (t.triggerHandler('uploader.previewing', [this.getFile(), id, attachment().get()]) === false) return this;\r\n\t\t\t\t\t\t\tattachment().add(id);\r\n\t\t\t\t\t\t\tt.triggerHandler('uploader.previewed',[this.getFile(), id, attachment().get()]);\r\n\t\t\t\t\t\t\treturn this;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tremove: function(){\r\n\t\t\t\t\t\t\tvar file = this.getFile();\r\n\t\t\t\t\t\t\tif (t.triggerHandler('uploader.removing', [file, id, attachment().get()]) === false) return this;\r\n\t\t\t\t\t\t\tif (file) flex_uploader.uploader.removeFile(file, true);\r\n\t\t\t\t\t\t\tattachment().remove(id);\r\n\t\t\t\t\t\t\t$thumbnails[id].remove();\r\n\t\t\t\t\t\t\tdelete $thumbnails[id];\r\n\t\t\t\t\t\t\tt.triggerHandler('uploader.removed',[file, id, attachment().get()]);\r\n\t\t\t\t\t\t\treturn this;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tsetFile: function(file){\r\n\t\t\t\t\t\t\t$thumbnails[id].data(\"file\", file);\r\n\t\t\t\t\t\t\treturn this;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tgetFile: function(){\r\n\t\t\t\t\t\t\treturn $thumbnails[id].data(\"file\");\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tremoveAll: function(){\r\n\t\t\t\t\t\t\tfor (var id in $thumbnails) {\r\n\t\t\t\t\t\t\t\tpreview(id).remove();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\trebuildAll: function() {\r\n\t\t\t\t\t\t\t//remove all files\r\n\t\t\t\t\t\t\tfiles = flex_uploader.uploader.getFiles();\r\n\t\t\t\t\t\t\tfor(var i = 0;i < files.length;i++)\r\n\t\t\t\t\t\t\t\tflex_uploader.uploader.removeFile(files[i], true);\r\n\t\t\t\t\t\t\t//remove all preview\r\n\t\t\t\t\t\t\tthis.removeAll();\r\n\t\t\t\t\t\t\t//build\r\n\t\t\t\t\t\t\tvar aids = attachment().get();\r\n\t\t\t\t\t\t\tfor (i = 0; i < aids.length; i++) {\r\n\t\t\t\t\t\t\t\tpreview(aids[i]).build();\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\treturn this;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t};\r\n\t\t\t\tvar attachment = function() {\r\n\t\t\t\t\tvar aid = t.val();\r\n\t\t\t\t\tif (aid == '0') aid = '';\r\n\t\t\t\t\taids = aid ? ( aid instanceof Array ? aid : aid.split(',') ) : [];\r\n\t\t\t\t\treturn {\r\n\t\t\t\t\t\twrite: function() {\r\n\t\t\t\t\t\t\tif (t.is('select')){\r\n\t\t\t\t\t\t\t\tt.empty();\r\n\t\t\t\t\t\t\t\taids.forEach(function(i){\r\n\t\t\t\t\t\t\t\t\tt.append('<option value=\"'+i+'\">'+i+'</option>');\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tt.val(aids);\r\n\t\t\t\t\t\t\treturn this;\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tadd: function(id) {\r\n\t\t\t\t\t\t\tif (options.filelimit == 1) aids = [id.toString()];\r\n\t\t\t\t\t\t\tvar i = aids.indexOf(id.toString());\r\n\t\t\t\t\t\t\tif (i == -1) aids.push(id.toString());\r\n\t\t\t\t\t\t\treturn this.write();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tremove: function(id) {\r\n\t\t\t\t\t\t\tvar i = aids.indexOf(id.toString());\r\n\t\t\t\t\t\t\tif (i != -1) aids.splice(i,1);\r\n\t\t\t\t\t\t\treturn this.write();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tremoveAll: function(){\r\n\t\t\t\t\t\t\taids = [];\r\n\t\t\t\t\t\t\treturn this.write();\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tget: function(){\r\n\t\t\t\t\t\t\treturn aids;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t};\r\n\r\n\r\n\t\t\t\t//---------------------------------------\r\n\t\t\t\tmethod.beforeFileQueued = function(file) {\r\n\t\t\t\t\tif (options.filetype.split(',').indexOf(file.ext.toLowerCase()) == -1){\r\n\t\t\t\t\t\t$.alert(UPLOADER_LANGUAGE.filetype.replace('{{0}}', options.filetype));\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (options.filelimit > 1 &&  attachment().get().length >= options.filelimit) {\r\n\t\t\t\t\t\t$.alert(UPLOADER_LANGUAGE.filenum_limite.replace('{{0}}', options.filelimit));\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t};\r\n\t\t\t\tmethod.fileQueued = function(file) {\r\n\t\t\t\t\tif (t.triggerHandler('uploader.uploading', [file, attachment().get()]) === false) return false;\r\n\t\t\t\t\tprogress(file).init().thumb();\r\n\r\n\t\t\t\t\t//前台压缩图片，检查的是源文件的MD5，而非压缩之后的，所以直接上传。另外：压缩之后的图片暂时无法检查BUG\r\n\t\t\t\t\tif (options.max_width > 0 && options.max_height > 0 && (file.ext == 'jpg' || file.ext == 'jpeg'))\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tflex_uploader.uploader.upload(file);\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.md5File( file ).progress(function(percentage) {\r\n\t\t\t\t\t\tprogress(file).progressing(0).message(UPLOADER_LANGUAGE.hashing + ' ' + (percentage * 100).toFixed(2) + '%');\r\n\t\t\t\t\t}).then(function(val) {\r\n\t\t\t\t\t\tLP.PUT(LP.baseuri + 'attachment/hash', {\r\n\t\t\t\t\t\t\thash: val,\r\n\t\t\t\t\t\t\t_token: LP.csrf,\r\n\t\t\t\t\t\t\tfilename: file.name,\r\n\t\t\t\t\t\t\text: file.ext,\r\n\t\t\t\t\t\t\tsize: file.size\r\n\t\t\t\t\t\t}).done(function(json) {\r\n\t\t\t\t\t\t\tflex_uploader.uploader.skipFile(file);\r\n\t\t\t\t\t\t\tprogress(file).success().message(UPLOADER_LANGUAGE.hash_success);\r\n\t\t\t\t\t\t\tif (options.filelimit == 1) preview().removeAll();\r\n\t\t\t\t\t\t\tpreview(json.data.id, json.data.filename, json.data.ext).build().setFile(file);\r\n\t\t\t\t\t\t\tt.triggerHandler('uploader.uploaded',[file, json, attachment().get()]);\r\n\t\t\t\t\t\t}).fail(function(){\r\n\t\t\t\t\t\t\tfile.md5 = val;\r\n\t\t\t\t\t\t\tflex_uploader.uploader.upload(file);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t};\r\n\t\t\t\tmethod.uploadBeforeSend = function(obj, data, headers) {\r\n\t\t\t\t\t//console.log(obj);\r\n\t\t\t\t\tdata.uuid = obj.blob.ruid + obj.file.id + obj.file.size;\r\n\t\t\t\t\tdata.start = obj.start;\r\n\t\t\t\t\tdata.end = obj.end;\r\n\t\t\t\t\tdata.chunks = obj.chunks;\r\n\t\t\t\t\tdata.chunk = obj.chunk;\r\n\t\t\t\t\tdata.total = obj.file.size;\r\n\t\t\t\t\tdata.hash = obj.file.md5;\r\n\t\t\t\t};\r\n\t\t\t\tmethod.uploadStart = function(file) {\r\n\t\t\t\t\t\r\n\t\t\t\t};\r\n\t\t\t\t//上传过程中触发，携带上传进度。\r\n\t\t\t\tmethod.uploadProgress = function(file, percentage) {\r\n\t\t\t\t\tt.triggerHandler('uploader.progressing',[file, percentage * 100, attachment().get()]);\r\n\t\t\t\t\tprogress(file).progressing(percentage * 100);\r\n\t\t\t\t};\r\n\t\t\t\t//当文件上传成功时触发。\r\n\t\t\t\tmethod.uploadSuccess = function(file, json) {\r\n\t\t\t\t\tvar message = json.message && json.message.content ? json.message.content : json.message;\r\n\t\t\t\t\tif (json && (json.result == 'success' || json.result == 'api')) {\r\n\t\t\t\t\t\tprogress(file).success();\r\n\t\t\t\t\t\tif (options.filelimit == 1) preview().removeAll();\r\n\t\t\t\t\t\tpreview(json.data.id, json.data.filename, json.data.ext).build().setFile(file);\r\n\t\t\t\t\t\tt.triggerHandler('uploader.uploaded',[file, json, attachment().get()]);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tprogress(file).error(UPLOADER_LANGUAGE.error+': ' + message);\r\n\t\t\t\t\t\tt.triggerHandler('uploader.error',[file, message, attachment().get()]);\r\n\t\t\t\t\t\t//$.alert(message);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\t\r\n\t\t\t\t//当文件上传出错时触发。\r\n\t\t\t\tmethod.uploadError = function(file, reason) {\r\n\t\t\t\t\tprogress(file).error(UPLOADER_LANGUAGE.error+': ' + reason);\r\n\t\t\t\t\tt.triggerHandler('uploader.error',[file, reason, attachment().get()]);\r\n\t\t\t\t};\r\n\t\t\t\t//不管成功或者失败，文件上传完成时触发。\r\n\t\t\t\tmethod.uploadComplete = function(file) {\r\n\t\t\t\t\t\r\n\t\t\t\t};\r\n\t\t\t\tmethod.error = function(code, max, file) {\r\n\t\t\t\t\tswitch(code)\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tcase 'Q_EXCEED_NUM_LIMIT':\r\n\t\t\t\t\t\t\t$.alert(UPLOADER_LANGUAGE.num_limit.replace('{{0}}', max));\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'Q_EXCEED_SIZE_LIMIT':\r\n\t\t\t\t\t\t\t$.alert(UPLOADER_LANGUAGE.allsize_limit);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'F_EXCEED_SIZE':\r\n\t\t\t\t\t\t\t$.alert(UPLOADER_LANGUAGE.filesize_limite.replace('{{0}}', bytesToSize(options.filesize)));\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'F_DUPLICATE':\r\n\t\t\t\t\t\t\t$.alert(UPLOADER_LANGUAGE.duplicate);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'Q_TYPE_DENIED':\r\n\t\t\t\t\t\t\t$.alert(UPLOADER_LANGUAGE.filetype.replace('{{0}}', options.filetype));\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t$.alert(code);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\r\n\t\t\t\tmethod.create = function()\r\n\t\t\t\t{\r\n\t\t\t\t\tif (flex_uploader.uploader || typeof t.prop('flex_uploader') == 'undefined' || typeof t.prop('flex_uploader').uploader != 'undefined') return;\r\n\t\t\t\t\tflex_uploader.uploader = WebUploader.create({\r\n\t\t\t\t\t\t// swf文件路径\r\n\t\t\t\t\t\tswf: LP.baseuri + \"static/js/webuploader/Uploader.swf\",\r\n\t\t\t\t\t\t// 文件接收服务端。\r\n\t\t\t\t\t\tserver: LP.baseuri + \"attachment/uploader?of=json\",\r\n\t\t\t\t\t\t// 选择文件的按钮。可选。内部根据当前运行是创建，可能是input元素，也可能是flash\r\n\t\t\t\t\t\tpick: {\r\n\t\t\t\t\t\t\tid: document.getElementById(pick_id),\r\n\t\t\t\t\t\t\tmultiple: true\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t//表单附加数据\r\n\t\t\t\t\t\tformData: $.extend(true, {}, {'_token': LP.csrf}),\r\n\t\t\t\t\t\t//文件表单name\r\n\t\t\t\t\t\tfileVal: 'Filedata',\r\n\t\t\t\t\t\t//METHOD\r\n\t\t\t\t\t\tmethod: 'POST',\r\n\t\t\t\t\t\t//二进制上传，php://input都为文件内容，其他参数在$_GET中\r\n\t\t\t\t\t\tsendAsBinary: false,\r\n\t\t\t\t\t\t//可提交文件数量限制\r\n\t\t\t\t\t\tfileNumLimit: 0,\r\n\t\t\t\t\t\t//总文件大小限制\r\n\t\t\t\t\t\t//fileSizeLimit: 1024 * 1024 * 1024, //1G\r\n\t\t\t\t\t\t//单文件大小限制\r\n\t\t\t\t\t\tfileSingleSizeLimit: options.filesize,\r\n\t\t\t\t\t\t//是否去重\r\n\t\t\t\t\t\tduplicate: false,\r\n\t\t\t\t\t\t// 文件选择筛选。\r\n\t\t\t\t\t\taccept: {\r\n\t\t\t\t\t\t\ttitle: UPLOADER_LANGUAGE.select_file,\r\n\t\t\t\t\t\t\textensions: options.filetype,\r\n\t\t\t\t\t\t\tmimeTypes: typeof mimeType != 'undefined' && !navigator.userAgent.indexOf('Chrome') ? options.filetype.split(',').map(function(v){return mimeType.lookup('name.' + v);}).join(',') : '*/*'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t//是否允许在文件传输时提前把下一个文件的分片,MD5准备好\r\n\t\t\t\t\t\tprepareNextFile: true,\r\n\t\t\t\t\t\t//分多大一片？ 默认大小为5M.\r\n\t\t\t\t\t\tchunkSize: 5242880,\r\n\t\t\t\t\t\t//分片允许自动重传多少次\r\n\t\t\t\t\t\tchunkRetry: 5,\r\n\t\t\t\t\t\t//是否分片上传。\r\n\t\t\t\t\t\tchunked: true,\r\n\t\t\t\t\t\t//同时上传并发数\r\n\t\t\t\t\t\tthreads: 3,\r\n\t\t\t\t\t\t//以下两个属性设置后，如果一个页面有多个uploader，会将rt_rt_xxxxx放到最后一个.webuploader-container容器内\r\n\t\t\t\t\t\t//指定拖拽的容器\r\n\t\t\t\t\t\t//dnd: document.getElementById(uploader_id),\r\n\t\t\t\t\t\t//全局禁用拉拽，防止默认打开文件\r\n\t\t\t\t\t\t//disableGlobalDnd: true,\r\n\t\t\t\t\t\t//可以粘贴的容器\r\n\t\t\t\t\t\t//paste: document.getElementById(uploader_id),\r\n\t\t\t\t\t\tthumb: {// 缩略图\r\n\t\t\t\t\t\t\twidth: 75,\r\n\t\t\t\t\t\t\theight: 75,\r\n\t\t\t\t\t\t\t// 图片质量，只有type为`image/jpeg`的时候才有效。\r\n\t\t\t\t\t\t\tquality: 70,\r\n\t\t\t\t\t\t\t// 是否允许放大，如果想要生成小图的时候不失真，此选项应该设置为false.\r\n\t\t\t\t\t\t\tallowMagnify: false,\r\n\t\t\t\t\t\t\t// 是否允许裁剪。\r\n\t\t\t\t\t\t\tcrop: true,\r\n\t\t\t\t\t\t\t// 为空的话则保留原有图片格式。\r\n\t\t\t\t\t\t\t// 否则强制转换成指定的类型。\r\n\t\t\t\t\t\t\t//type: 'image/jpeg'\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t// 不压缩image, 默认如果是jpeg，文件上传前会压缩一把再上传！\r\n\t\t\t\t\t\tresize: false,\r\n\t\t\t\t\t\tcompress: null\r\n\t\t\t\t\t});\r\n\t\t\t\t\t// 修改后图片上传前，尝试将图片压缩到max_width * max_height\r\n\t\t\t\t\tif (options.max_width > 0 && options.max_height > 0)\r\n\t\t\t\t\t\tflex_uploader.uploader.option( 'compress', {\r\n\t\t\t\t\t\t\twidth: options.max_width,\r\n\t\t\t\t\t\t\theight: options.max_height,\r\n\t\t\t\t\t\t\t// 图片质量，只有type为`image/jpeg`的时候才有效。\r\n\t\t\t\t\t\t\tquality: 100,\r\n\t\t\t\t\t\t\t// 是否允许放大，如果想要生成小图的时候不失真，此选项应该设置为false.\r\n\t\t\t\t\t\t\tallowMagnify: false,\r\n\t\t\t\t\t\t\t// 是否允许裁剪。\r\n\t\t\t\t\t\t\tcrop: false,\r\n\t\t\t\t\t\t\t// 是否保留头部meta信息。\r\n\t\t\t\t\t\t\tpreserveHeaders: true,\r\n\t\t\t\t\t\t\t// 如果发现压缩后文件大小比原来还大，则使用原来图片。此属性可能会影响图片自动纠正功能\r\n\t\t\t\t\t\t\tnoCompressIfLarger: true,\r\n\t\t\t\t\t\t\t// 单位字节，如果图片大小小于此值，不会采用压缩。\r\n\t\t\t\t\t\t\tcompressSize: 0\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\tflex_uploader.uploader.on('beforeFileQueued', method.beforeFileQueued);\r\n\t\t\t\t\tflex_uploader.uploader.on('fileQueued', method.fileQueued);\r\n\t\t\t\t\tflex_uploader.uploader.on('uploadBeforeSend', method.uploadBeforeSend);\r\n\t\t\t\t\tflex_uploader.uploader.on('uploadStart', method.uploadStart);\r\n\t\t\t\t\tflex_uploader.uploader.on('uploadProgress', method.uploadProgress);\r\n\t\t\t\t\tflex_uploader.uploader.on('uploadSuccess', method.uploadSuccess);\r\n\t\t\t\t\tflex_uploader.uploader.on('uploadError', method.uploadError);\r\n\t\t\t\t\tflex_uploader.uploader.on('uploadComplete', method.uploadComplete);\r\n\t\t\t\t\tflex_uploader.uploader.on('error', method.error);\r\n\r\n\t\t\t\t\tt.prop('flex_uploader', flex_uploader);\r\n\t\t\t\t\t//init\r\n\t\t\t\t\tif(options.id) attachment().add(options.id);\r\n\t\t\t\t\tpreview().rebuildAll();\r\n\t\t\t\t};\r\n\r\n\t\t\t\tt.prop('flex_uploader', flex_uploader);\r\n\r\n\t\t\t\tif (!flex_uploader.$container.is(':visible')/* flex_uploader.$container[0].offsetParent === null*/) { //如果默认隐藏状态(即使是父级隐藏)，需要特殊处理\r\n\t\t\t\t\tmethod.interval = setInterval(function(){\r\n\t\t\t\t\t\tif (flex_uploader.$container.is(':visible'))\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tclearInterval(method.interval);\r\n\t\t\t\t\t\t\tmethod.create();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, 500); //还能有更好的方法吗? MutationObserver?\r\n\r\n\t\t\t\t} else {\r\n\t\t\t\t\tmethod.create();\r\n\t\t\t\t}\r\n\r\n\t\t\t});\r\n\t\t\t\r\n\t\t}\r\n\t});\r\n})(jQuery);"]}