/*! laravel.select.js 2016-12-02 09:37:47*/
!function(e){var t={cacheData:{}};t.getData=function(a,n){var r=JSON.stringify({url:a,params:n}),s=jQuery.Deferred();return"undefined"!=typeof t.cacheData[r]?s.resolve(t.cacheData[r]):e.POST(a,n).done(function(e,a,n){if("success"==e.result||"api"==e.result){var l=e.data.data;t.cacheData[r]=l,s.resolve(t.cacheData[r])}else{var i=arguments;s.reject.apply(s,i)}}).fail(function(){var e=arguments;s.reject.apply(s,e)}),s.promise()},t.replaceData=function(e,t){return t.replace(/\{\{([\w\.]+)\}\}/g,function(t,a){for(var n=a.split("."),r=e,s=0;s<n.length;++s){var l=n[s];if("undefined"==typeof r[l])return null;r=r[l]}return r})},t.format=function(e,a,n,r){for(var s=[],l=0;l<e.length;++l){var i={id:a?t.replaceData(e[l],a):e[l].id,text:n?t.replaceData(e[l],n):e[l].text,pid:r?t.replaceData(e[l],r):e[l].pid};"object"==typeof e[l].children&&"undefined"!=typeof e[l].children.length&&(i.children=t.format(e[l].children,a,n)),s.push(i)}return s},t.recursive=function(e,a){a="undefined"==typeof a?"":a;for(var n=[],r=0;r<e.length;++r){var s=e[r],l="treeline ";l+=0!==r||a?r==e.length-1?"bottom-":"center-":"top-",l+=s.children?"open":"line";var i={id:s.id,selection:s.text,text:a+'<span class="'+l+'"></span>'+s.text};if(n.push(i),s.children)for(var c=t.recursive(s.children,a+(r==e.length-1?'<span class="treeline blank"></span>':'<span class="treeline blank-line"></span>')),o=0;o<c.length;++o)n.push(c[o])}return n},e.fn.extend({selectModel:function(a){return"destroy"==a?this.select2("destroy"):"open"==a?this.select2("open"):"close"==a?this.select2("close"):this.each(function(){var n=e(this),r=n.data("id"),s=n.data("text"),l=n.data("params"),i=n.attr("value"),c=e.baseuri+n.data("model")+"/data/json";l=e.extend(!0,{all:"true"},l),t.getData(c,l).done(function(l){var c=t.format(l,r,s);n.select2(e.extend(!0,{language:"zh-CN",data:c,allowClear:!0},a)),n.val(i?i.split(","):null).trigger("change")})})},treeModel:function(a){return"destroy"==a?this.select2("destroy"):"open"==a?this.select2("open"):"close"==a?this.select2("close"):this.each(function(){var n=e(this),r=n.data("id"),s=n.data("pid"),l=n.data("text"),i=n.data("params"),c=n.attr("value"),o=e.baseuri+n.data("model")+"/data/json";i=e.extend(!0,{all:"true",tree:"true"},i),t.getData(o,i).done(function(i){var o=t.format(i,r,l,s);o=t.recursive(o),n.select2(e.extend(!0,{language:"zh-CN",data:o,allowClear:!0,templateResult:function(t){return e("<div>"+t.text+"</div>")},templateSelection:function(e){return e.selection}},a)),n.val(c?c.split(","):null).trigger("change")})})},suggestModel:function(a){return"destroy"==a?this.select2("destroy"):"open"==a?this.select2("open"):"close"==a?this.select2("close"):this.each(function(){var n=e(this),r=n.data("id"),s=n.data("text"),l=n.data("selection")?n.data("selection"):s,i=n.data("term"),c=n.attr("value"),o={language:"zh-CN",ajax:{url:e.baseuri+n.data("model")+"/data/json",dataType:"json",type:"post",delay:250,data:function(t){var a=n.data("params"),r={page:t.page,_token:e.crsf,filters:{}};return r.filters[i]={like:t.term},r=e.extend(!0,r,a)},processResults:function(e,a){if("success"!=e.result&&"api"!=e.result)return{result:[]};for(var n=[],i=e.data.data,c=0;c<i.length;++c)n.push({id:r?t.replaceData(i[c],r):i[c].id,text:s?t.replaceData(i[c],s):i[c].text,selection:l?t.replaceData(i[c],l):i[c].selection});return{results:n}},cache:!0},escapeMarkup:function(e){return e},minimumInputLength:1,allowClear:!0,templateResult:function(e){return e.text},templateSelection:function(e){return e.selection||e.text}};c?e.POST(e.baseuri+n.data("model")+"/data/json",{"filters[id][in]":c.split(",")},function(l){if("success"==l.result||"api"==l.result)for(var i=l.data.data,c=0;c<i.length;++c)e('<option value="'+(r?t.replaceData(i[c],r):i[c].id)+'" selected="selected">'+(s?t.replaceData(i[c],s):i[c].text)+"</option>").appendTo(n);n.select2(e.extend(!0,o,a))},!1):n.select2(e.extend(!0,o,a))})},tags:function(t){return"destroy"==t?this.select2("destroy"):"open"==t?this.select2("open"):"close"==t?this.select2("close"):this.each(function(){var a=e(this),n={language:"zh-CN",ajax:{url:e.baseuri+"admin/tag/data/json",dataType:"json",type:"post",delay:250,data:function(t){var n=a.data("params"),r={page:t.page,_token:e.crsf,filters:{}};return r.filters.keywords={like:t.term},r=e.extend(!0,r,n)},processResults:function(e,t){if("success"!=e.result&&"api"!=e.result)return{result:[]};for(var a=[],n=e.data.data,r=0;r<n.length;++r)a.push({id:n[r].keywords,text:n[r].keywords+' <span class="text-muted">('+(n[r].count||0)+"\u6b21\u4f7f\u7528)</span>",selection:n[r].keywords});return{results:a}},cache:!0},escapeMarkup:function(e){return e},minimumInputLength:1,templateResult:function(e){return e.text},templateSelection:function(e){return e.selection||e.text},createTag:function(t){var a=e.trim(t.term);return""===a?null:{id:a,selection:a,text:a+' <span style="color:#f5f5f5">(\u521b\u5efa)</span>',newTag:!0}}};a.select2(e.extend(!0,{tags:!0},n,t))})}}),e().ready(function(){e(".select-model").selectModel(),e(".tree-model").treeModel(),e(".suggest-model").suggestModel()})}(jQuery);
//# sourceMappingURL=laravel.select.min.js.map
