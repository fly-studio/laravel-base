/*! laravel.select.js 2016-11-21 19:33:23*/
!function(e){e().ready(function(){var t={cacheData:{}};t.getData=function(a,r){var n=JSON.stringify({url:a,params:r}),l=jQuery.Deferred();return"undefined"!=typeof t.cacheData[n]?l.resolve(t.cacheData[n]):e.POST(a,r).done(function(e,a,r){if("success"==e.result||"api"==e.result){var s=e.data.data;t.cacheData[n]=s,l.resolve(t.cacheData[n])}else{var i=arguments;l.reject.apply(l,i)}}).fail(function(){var e=arguments;l.reject.apply(l,e)}),l.promise()},t.replaceData=function(e,t){return t.replace(/\{([\w\.]+)\}/g,function(t,a){for(var r=a.split("."),n=e,l=0;l<r.length;++l){var s=r[l];if("undefined"==typeof n[s])return null;n=n[s]}return n})},t.format=function(e,a,r,n){for(var l=[],s=0;s<e.length;++s){var i={id:a?t.replaceData(e[s],a):e[s].id,text:r?t.replaceData(e[s],r):e[s].text,pid:n?t.replaceData(e[s],n):e[s].pid};"object"==typeof e[s].children&&"undefined"!=typeof e[s].children.length&&(i.children=t.format(e[s].children,a,r)),l.push(i)}return l},t.recursive=function(e,a){a="undefined"==typeof a?"":a;for(var r=[],n=0;n<e.length;++n){var l=e[n],s="treeline ";s+=0!==n||a?n==e.length-1?"bottom-":"center-":"top-",s+=l.children?"open":"line";var i={id:l.id,selection:l.text,text:a+'<span class="'+s+'"></span>'+l.text};if(r.push(i),l.children)for(var u=t.recursive(l.children,a+(n==e.length-1?'<span class="treeline blank"></span>':'<span class="treeline blank-line"></span>')),c=0;c<u.length;++c)r.push(u[c])}return r},e(".select-model").each(function(){var a=e(this),r=a.data("id"),n=a.data("text"),l=a.data("params"),s=a.attr("value"),i=e.baseuri+a.data("model")+"/data/json";l=e.extend({},{all:"true"},l),t.getData(i,l).done(function(e){var l=t.format(e,r,n);a.select2({language:"zh-CN",data:l,allowClear:!0}),a.val(s?s.split(","):null).trigger("change")})}),e(".tree-model").each(function(){var a=e(this),r=a.data("id"),n=a.data("pid"),l=a.data("text"),s=a.data("params"),i=a.attr("value"),u=e.baseuri+a.data("model")+"/data/json";s=e.extend({},{all:"true",tree:"true"},s),t.getData(u,s).done(function(s){var u=t.format(s,r,l,n);u=t.recursive(u),a.select2({language:"zh-CN",data:u,allowClear:!0,templateResult:function(t){return e("<div>"+t.text+"</div>")},templateSelection:function(e){return e.selection}}),a.val(i?i.split(","):null).trigger("change")})}),e(".suggest-model").each(function(){var a=e(this),r=a.data("id"),n=a.data("text"),l=a.data("selection")?a.data("selection"):n,s=a.data("term"),i=a.data("filters"),u=a.attr("value"),c={language:"zh-CN",ajax:{url:e.baseuri+a.data("model")+"/data/json",dataType:"json",type:"post",delay:250,data:function(t){var a={page:t.page,_token:e.crsf,filters:{}};return a.filters[s]={like:t.term},a.filters=e.extend({},a.filters,i),a},processResults:function(e,a){if("success"!=e.result&&"api"!=e.result)return{result:[]};for(var s=[],i=e.data.data,u=0;u<i.length;++u)s.push({id:r?t.replaceData(i[u],r):i[u].id,text:n?t.replaceData(i[u],n):i[u].text,selection:l?t.replaceData(i[u],l):i[u].selection});return{results:s}},cache:!0},escapeMarkup:function(e){return e},minimumInputLength:1,allowClear:!0,templateResult:function(e){return e.text},templateSelection:function(e){return e.selection||e.text}};u?e.POST(e.baseuri+a.data("model")+"/data/json",{"filters[id][in]":u.split(",")},function(l){if("success"==l.result||"api"==l.result)for(var s=l.data.data,i=0;i<s.length;++i)e('<option value="'+(r?t.replaceData(s[i],r):s[i].id)+'" selected="selected">'+(n?t.replaceData(s[i],n):s[i].text)+"</option>").appendTo(a);a.select2(c)},!1):a.select2(c)}),e.fn.extend({tags:function(t){return this.each(function(){var a=e(this),r={language:"zh-CN",ajax:{url:e.baseuri+"admin/tag/data/json",dataType:"json",type:"post",delay:250,data:function(a){var r={page:a.page,_token:e.crsf,filters:{}};return r.filters.keywords={like:a.term},r.filters=e.extend({},r.filters,t),r},processResults:function(e,t){if("success"!=e.result&&"api"!=e.result)return{result:[]};for(var a=[],r=e.data.data,n=0;n<r.length;++n)a.push({id:r[n].keywords,text:r[n].keywords+' <span class="text-muted">('+(r[n].count||0)+"\u6b21\u4f7f\u7528)</span>",selection:r[n].keywords});return{results:a}},cache:!0},escapeMarkup:function(e){return e},minimumInputLength:1,templateResult:function(e){return e.text},templateSelection:function(e){return e.selection||e.text},createTag:function(t){var a=e.trim(t.term);return""===a?null:{id:a,selection:a,text:a+' <span style="color:#f5f5f5">(\u521b\u5efa)</span>',newTag:!0}}};a.select2(e.extend({tags:!0},r))})}})})}(jQuery);
//# sourceMappingURL=laravel.select.min.js.map
