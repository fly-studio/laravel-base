/*! laravel.select.js 2016-12-30 17:02:53*/
!function(e){var t={cacheData:{}};t.getData=function(a,n){var r=JSON.stringify({url:a,params:n}),l=jQuery.Deferred();return"undefined"!=typeof t.cacheData[r]?l.resolve(t.cacheData[r]):e.POST(a,n).done(function(e,a,n){if("success"==e.result||"api"==e.result){var s=e.data.data;t.cacheData[r]=s,l.resolve(t.cacheData[r])}else{var o=arguments;l.reject.apply(l,o)}}).fail(function(){var e=arguments;l.reject.apply(l,e)}),l.promise()},t.replaceData=function(e,t){return t.replace(/\{\{([\w\.]+)\}\}/g,function(t,a){for(var n=a.split("."),r=e,l=0;l<n.length;++l){var s=n[l];if("undefined"==typeof r[s])return null;r=r[s]}return r})},t.format=function(e,a,n,r,l){for(var s=[],o=0;o<e.length;++o){var i={id:a?t.replaceData(e[o],a):e[o].id,text:r?t.replaceData(e[o],r):e[o].text,selection:n?t.replaceData(e[o],n):e[o].selection,pid:l?t.replaceData(e[o],l):e[o].pid};"object"==typeof e[o].children&&"undefined"!=typeof e[o].children.length&&(i.children=t.format(e[o].children,a,n,r,l)),s.push(i)}return s},t.recursive=function(e,a){a="undefined"==typeof a?"":a;for(var n=[],r=0;r<e.length;++r){var l=e[r],s="treeline ";s+=0!==r||a?r==e.length-1?"bottom-":"center-":"top-",s+=l.children?"open":"line";var o={id:l.id,selection:l.selection,text:a+'<span class="'+s+'"></span>'+l.text};if(n.push(o),l.children)for(var i=t.recursive(l.children,a+(r==e.length-1?'<span class="treeline blank"></span>':'<span class="treeline blank-line"></span>')),d=0;d<i.length;++d)n.push(i[d])}return n},e.fn.extend({selectModel:function(a){return"destroy"==a?this.select2("destroy"):"open"==a?this.select2("open"):"close"==a?this.select2("close"):this.each(function(){var n=e(this),r=n.data("id"),l=n.data("text"),s=n.data("selection")?n.data("selection"):l,o=n.data("params"),i=n.attr("value")?n.attr("value").split(","):n.val(),d=e.baseuri+n.data("model")+"/data/json";o=e.extend(!0,{},{all:"true"},o),t.getData(d,o).done(function(o){var d=t.format(o,r,s,l);n.select2(e.extend(!0,{},{language:"zh-CN",data:d,allowClear:!0},a)),n.val(i?i:null).trigger("change")})})},treeModel:function(a){return"destroy"==a?this.select2("destroy"):"open"==a?this.select2("open"):"close"==a?this.select2("close"):this.each(function(){var n=e(this),r=n.data("id"),l=n.data("pid"),s=n.data("text"),o=n.data("selection")?n.data("selection"):s,i=n.data("params"),d=n.attr("value")?n.attr("value").split(","):n.val(),c=e.baseuri+n.data("model")+"/data/json";i=e.extend(!0,{},{all:"true",tree:"true"},i),t.getData(c,i).done(function(i){var c=t.format(i,r,o,s,l);c=t.recursive(c),n.select2(e.extend(!0,{},{language:"zh-CN",data:c,allowClear:!0,templateResult:function(t){return e("<div>"+t.text+"</div>")},templateSelection:function(e){return e.selection}},a)),n.val(d?d:null).trigger("change")})})},suggestModel:function(a){return"destroy"==a?this.select2("destroy"):"open"==a?this.select2("open"):"close"==a?this.select2("close"):this.each(function(){var n=e(this),r=n.data("id"),l=n.data("text"),s=n.data("selection")?n.data("selection"):l,o=n.data("term")?n.data("term"):null,i=n.data("q")?n.data("q"):null,d=n.attr("value")?n.attr("value").split(","):n.val(),c=e.baseuri+n.data("model")+"/data/json",u={language:"zh-CN",ajax:{delay:500,transport:function(a,d,u){var f=n.data("params"),p={page:a.data.page,f:{},q:{}};o&&(p.f[o]={like:a.data.term}),i&&(p.q[i]=a.data.q),t.getData(c,e.extend(!0,{},p,f)).done(function(e){var a=t.format(e,r,s,l);d(a)})},processResults:function(e,t){return{results:e}}},escapeMarkup:function(e){return e},minimumInputLength:2,allowClear:!0,templateResult:function(e){return e.text},templateSelection:function(e){return e.selection||e.text}};if(d){var f=n.data("params");t.getData(c,e.extend(!0,{},f,{f:{id:{in:d}}})).done(function(o){var i=t.format(o,r,s,l);n.select2(e.extend(!0,{},u,a,{data:i}))})}else n.select2(e.extend(!0,{},u,a))})},tagsModel:function(a){return"destroy"==a?this.select2("destroy"):"open"==a?this.select2("open"):"close"==a?this.select2("close"):this.each(function(){var n=e(this),r=n.data("term")?n.data("term"):null,l=n.data("q")?n.data("q"):null;r||l||(r="keywords");var s=n.data("id")?n.data("id"):"{{keywords}}",o=n.data("text")?n.data("text"):'{{keywords}} <span class="text-muted">({{count}}\u6b21\u4f7f\u7528)</span>',i=n.data("selection")?n.data("selection"):"{{keywords}}",d=n.attr("value")?n.attr("value").split(","):n.val(),c=e.baseuri+(n.data("model")?n.data("model"):"admin/tag")+"/data/json",u={language:"zh-CN",ajax:{delay:500,transport:function(a,d,u){var f=n.data("params"),p={page:a.data.page,f:{},q:{}};r&&(p.f[r]={like:a.data.term}),l&&(p.q[l]=a.data.q),t.getData(c,e.extend(!0,{},p,f)).done(function(e){var a=t.format(e,s,i,o);d(a)})},processResults:function(e,t){return{results:e}}},escapeMarkup:function(e){return e},minimumInputLength:1,templateResult:function(e){return e.text},templateSelection:function(e){return e.selection||e.text},createTag:function(t){var a=e.trim(t.term);return""===a?null:{id:a,selection:a,text:a+' <span style="color:#f5f5f5">(\u521b\u5efa)</span>',newTag:!0}}};if(d){var f=n.data("params"),p={f:{id:{in:d}},q:{}};t.getData(c,e.extend(!0,{},p,f)).done(function(r){var l=t.format(r,s,i,o);n.select2(e.extend(!0,{},u,a,{data:l}))})}else n.select2(e.extend(!0,{},u,a))})}}),e().ready(function(){e(".select-model").selectModel(),e(".tree-model").treeModel(),e(".suggest-model").suggestModel(),e(".tags-model").tagsModel()})}(jQuery);
//# sourceMappingURL=laravel.select.min.js.map
