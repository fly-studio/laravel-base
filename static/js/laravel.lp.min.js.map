{"version":3,"sources":["laravel.lp.js"],"names":["LP","QUERY_LANGUAGE","error","reload","redirect","unselected","network_timeout","parser_error","server_error","encrypt_key","encrypt_js","encrypt_string","encrypt_unserialize","thiscript","document","currentScript","scripts","getElementsByTagName","length","window","baseuri","src","toString","match","replace","JSEncrypt","sessionStorage","getRSAKey","rsa","getItem","JSON","parse","crypt","default_key_size","key","getKey","private","getPrivateKey","public","getPublicKey","setItem","stringify","sslFunc","this","encrypt","text","setKey","decrypt","ssl","jQuery","$","csrf","attr","headers","encodeURIComponent","ajaxSetup","dataFilter","data","type","jsonError","content","result","message","title","toLowerCase","json","parseJSON","encrypted","encrypted_json","e","console","log","stack","s","base64js","toByteArray","aesjs","util","convertBytesToString","keyBytes","ivBytes","iv","valueBytes","value","aesCbc","ModeOfOperation","cbc","decryptedBytes","decypted","unserialize","debug","query","method","url","_this","_headers","_data","$dfd","Deferred","String","deparam","_method","_token","ajax","async","cache","toUpperCase","timeout","dataType","test","success","textStatus","jqXHR","args","arguments","reject","apply","resolve","XMLHttpRequest","errorThrown","promise","each","index","callback","$dtd","call","isFunction","done","tip","tipType","tipConfig","lptip_interface","alert","noHTML","setTimeout","self","location","href","queryTip","fail","toast","fn","extend","$this","is_form","is","on","off","validator","settings","submitHandler","f","selector","$selector","add","isEmptyObject","invalid","serializeArray","msg","$doms","filter","prop","$t","o","offset","show_loading","left","width","top","appendTo","always","remove","removeAttr","confirm","stopImmediatePropagation","lp-query"],"mappings":"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","file":"laravel.lp.min.js","sourcesContent":["var LP = {};\r\nvar QUERY_LANGUAGE = {\r\n\t'error' : '错误',\r\n\t'reload' : '重新载入',\r\n\t'redirect' : '页面跳转',\r\n\t'unselected' : '请至少选择一项！',\r\n\t'network_timeout' : '网络故障，请检查网络连接后重试！',\r\n\t'parser_error' : '数据解析失败，刷新重试下？',\r\n\t'server_error' : '服务器可能出现了点问题，刷新页面重试下？',\r\n\t'encrypt_key' : '数据已经加密，但未传递正确的公钥。',\r\n\t'encrypt_js' : '数据已经加密，但页面未加载解密JS。',\r\n\t'encrypt_string' : '数据已经加密，但密文解密失败，请联系管理员。',\r\n\t'encrypt_unserialize' : '数据已经加密，但解密后反序列化失败，请联系管理员。',\r\n};\r\n(function(){\r\n\t//base uri\r\n\tvar thiscript = document.currentScript;\r\n\tif (!thiscript) {\r\n\t\tvar scripts = document.getElementsByTagName(\"script\");\r\n\t\tthiscript = scripts[ scripts.length - 1 ];\r\n\t}\r\n\twindow.baseuri = thiscript.src.toString().match(/[^\\/:](\\/.*)static\\/js\\/laravel\\.lp(\\.min)?\\.js/i) ? thiscript.src.toString().match(/[^\\/:](\\/.*)static\\/js\\/laravel\\.lp(\\.min)?\\.js/i)[1] : thiscript.src.toString().replace(/\\\\/g, '/').replace(/\\/[^\\/]*\\/?$/, '') + '/';\r\n\tif (!window.baseuri) window.baseuri = '/';\r\n\tLP.baseuri = window.baseuri;\r\n})();\r\n(function(){\r\n\t//ssl\r\n\tif (typeof JSEncrypt != 'undefined' && window.sessionStorage) {\r\n\t\tvar getRSAKey = function() {\r\n\t\t\tvar rsa = window.sessionStorage.getItem('l+rsa');\r\n\t\t\tif (rsa) rsa = JSON.parse(rsa);\r\n\t\t\tif (!rsa)\r\n\t\t\t{\r\n\t\t\t\tvar crypt = new JSEncrypt({default_key_size:1024});\r\n\t\t\t\tvar key = crypt.getKey();\r\n\r\n\t\t\t\trsa = {\r\n\t\t\t\t\tprivate: key.getPrivateKey(),\r\n\t\t\t\t\tpublic: key.getPublicKey(),\r\n\t\t\t\t};\r\n\t\t\t\twindow.sessionStorage.setItem('l+rsa',JSON.stringify(rsa));\r\n\t\t\t}\r\n\t\t\treturn rsa;\r\n\t\t};\r\n\t\tvar sslFunc = function()\r\n\t\t{\r\n\t\t\tthis.rsa = getRSAKey();\r\n\t\t\tthis.encrypt = function(text) {\r\n\t\t\t\tvar crypt = new JSEncrypt();\r\n\t\t\t\tcrypt.setKey(this.rsa.public);\r\n\t\t\t\treturn crypt.encrypt(text);\r\n\t\t\t};\r\n\t\t\tthis.decrypt = function(text) {\r\n\t\t\t\tvar crypt = new JSEncrypt();\r\n\t\t\t\tcrypt.setKey(this.rsa.private);\r\n\t\t\t\treturn crypt.decrypt(text);\r\n\t\t\t};\r\n\t\t};\r\n\t\tLP.ssl = new sslFunc();\r\n\t}\r\n})(jQuery);\r\n\r\n(function($){\r\n\r\n\tLP.csrf = $('meta[name=\"csrf-token\"]').attr('content');\r\n\t//init csrf\r\n\tvar headers = {};\r\n\tif (LP.csrf)\r\n\t\theaders['X-CSRF-TOKEN'] = LP.csrf;\r\n\tif (LP.ssl)\r\n\t\theaders['X-RSA'] = encodeURIComponent(LP.ssl.rsa.public);\r\n\r\n\t//init ssl\r\n\t$.ajaxSetup({headers: headers, dataFilter: function(data, type){\r\n\t\tvar callback = ''; \r\n\t\tvar jsonError = function(content) {\r\n\t\t\tvar data = {};\r\n\t\t\tdata.result = 'error';\r\n\t\t\tdata.message = {title: QUERY_LANGUAGE.error, content: content};\r\n\t\t\treturn JSON.stringify(data);\r\n\t\t};\r\n\t\t//if (type.toLowerCase() == 'jsonp') //unsupport jsonp\r\n\t\t//\tcallback = '';\r\n\t\tif (type.toLowerCase() == 'json') {\r\n\t\t\tvar json = $.parseJSON(data);\r\n\t\t\tif (typeof json != 'undefined' && typeof json.result != 'undefined' && json.result == 'api' && typeof json.encrypted == 'string')\r\n\t\t\t{\r\n\t\t\t\tvar key,encrypted_json,encrypted;\r\n\t\t\t\tif (typeof LP.ssl != 'undefined') {\r\n\t\t\t\t \ttry{\r\n\t\t\t\t\t\tkey = LP.ssl.decrypt(json.encrypted);\r\n\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\tconsole.log(e.stack);\r\n\t\t\t\t\t\treturn jsonError(QUERY_LANGUAGE.encrypt_key + e.message);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tencrypted = json.data;\r\n\t\t\t\t\ttry{\r\n\t\t\t\t\t\tvar s = base64js.toByteArray(encrypted);\r\n\t\t\t\t\t\tencrypted_json = JSON.parse(aesjs.util.convertBytesToString(s)); //json_decode()\r\n\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\tconsole.log(e.stack);\r\n\t\t\t\t\t\treturn jsonError(QUERY_LANGUAGE.encrypt_string + e.message);\r\n\t\t\t\t\t}\r\n\t\t\t\t\ttry{\r\n\t\t\t\t\t\t//base64 decode\r\n\t\t\t\t\t\tvar keyBytes = base64js.toByteArray(key),\r\n\t\t\t\t\t\tivBytes = base64js.toByteArray(encrypted_json.iv),\r\n\t\t\t\t\t\tvalueBytes = base64js.toByteArray(encrypted_json.value);\r\n\t\t\t\t\t\t//aes cbc\r\n\t\t\t\t\t\tvar aesCbc = new aesjs.ModeOfOperation.cbc(keyBytes, ivBytes);\r\n\t\t\t\t\t\tvar decryptedBytes = aesCbc.decrypt(valueBytes);\r\n\t\t\t\t\t\tvar decypted = aesjs.util.convertBytesToString(decryptedBytes);\r\n\t\t\t\t\t\t//unserialize\r\n\t\t\t\t\t\tjson.data = unserialize(decypted);\r\n\t\t\t\t\t\tdelete json.key;\r\n\t\t\t\t\t} catch(e) {\r\n\t\t\t\t\t\tconsole.log(e.stack);\r\n\t\t\t\t\t\treturn jsonError(QUERY_LANGUAGE.encrypt_unserialize + e.message);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} else if (!json.key)\r\n\t\t\t\t\treturn jsonError(QUERY_LANGUAGE.encrypt_key);\r\n\t\t\t\telse \r\n\t\t\t\t\treturn jsonError(QUERY_LANGUAGE.encrypt_js);\r\n\t\t\t}\r\n\t\t\tdelete json.encrypted;\r\n\t\t\tdata = JSON.stringify(json);\r\n\t\t\tif (typeof json.debug != 'undefined' && !!json.debug) console.log(json);\r\n\t\t\t//delete json;\r\n\t\t}\r\n\r\n\t\treturn data;\r\n\t}});\r\n\r\n\tLP.query = function(method, url, data){\r\n\t\tvar _this = this, _headers = {}, _data = data;\r\n\t\tvar $dfd = jQuery.Deferred();\r\n\t\tif (data && data instanceof String) _data = $.deparam(data);\r\n\t\t//使用POST模拟的PUT或者DELETE等\r\n\t\tif (_data && _data._method) {\r\n\t\t\tmethod = _data._method;\r\n\t\t\t_headers['X-HTTP-Method-Override'] = method;\r\n\t\t}\r\n\t\tif (_data && _data._token) //add csrf\r\n\t\t\t_headers['X-CSRF-TOKEN'] = _data._token;\r\n\r\n\t\t$.ajax({\r\n\t\t\turl : url,\r\n\t\t\tdata : _data ? _data : null,\r\n\t\t\tasync : true, \r\n\t\t\tcache : false,\r\n\t\t\ttype : method.toUpperCase(),\r\n\t\t\theaders: _headers,\r\n\t\t\ttimeout : 20000,\r\n\t\t\tdataType : /[\\?&](jsonp|callback)=\\?/i.test(url) ? 'jsonp' : 'json',\r\n\t\t\tsuccess : function(json, textStatus, jqXHR) {\r\n\t\t\t\tvar args = arguments;\r\n\t\t\t\tif (typeof json != 'undefined' && typeof json.result != 'undefined' && (json.result == 'success' || json.result == 'api'))\r\n\t\t\t\t\t$dfd.resolve.apply(_this, args);\r\n\t\t\t\telse\r\n\t\t\t\t\t$dfd.reject.apply(_this, args);\r\n\t\t\t},\r\n\t\t\terror : function(XMLHttpRequest, textStatus, errorThrown) {\r\n\t\t\t\tvar args = arguments;\r\n\t\t\t\t$dfd.reject.apply(_this, args);\r\n\t\t\t}\r\n\t\t});\r\n\t\treturn $dfd.promise();\r\n\t};\r\n\r\n\t\r\n\r\n\t$.each(['get', 'post', 'head', 'patch', 'put', 'delete'], function(index, method) {\r\n\t\tLP[method] = LP[method.toUpperCase()] = function(url, data, callback) {\r\n\t\t\tvar _this = this;\r\n\t\t\tvar $dtd = LP.query.call(_this, method, url, data);\r\n\t\t\tif (callback && $.isFunction(callback)) $dtd.done(function(){\r\n\t\t\t\tvar args = arguments;\r\n\t\t\t\tcallback.apply(_this, args);\r\n\t\t\t});\r\n\t\t\treturn $dtd;\r\n\t\t};\r\n\t});\r\n\r\n\tLP.tip = function(result, message, tipType, tipConfig) {\r\n\t\tif (typeof message == 'undefined' || typeof tipType != 'object') return;\r\n\t\telse if (typeof message == 'string') message = {content: message};\r\n\r\n\t\tif (typeof $.lptip_interface != 'undefined') {\r\n\t\t\t$.lptip_interface(result, message, tipType, tipConfig);\r\n\t\t} else\r\n\t\t\talert(message.content.noHTML());\r\n\r\n\t\tswitch(tipType.type)\r\n\t\t{\r\n\t\t\tcase 'redirect':\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tself.location.href = tipType.url;\r\n\t\t\t\t}, tipType.timeout);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'refresh':\r\n\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\tself.location.reload();\r\n\t\t\t\t}, tipType.timeout);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'back':\r\n\t\t\tcase 'toast':\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t};\r\n\r\n\tLP.queryTip = function(method, url, data, tipConfig)\r\n\t{\r\n\t\ttipConfig = typeof tipConfig == 'undefined' ? {} : tipConfig;\r\n\t\tvar _this = this;\r\n\t\tvar $dtd = LP.query.call(_this, method, url, data);\r\n\t\tif (tipConfig !== false)\r\n\t\t\t$dtd.done(function(json){\r\n\t\t\t\tLP.tip.call(_this, json.result, json.message, json.tipType, tipConfig);\r\n\t\t\t}).fail(function(XMLHttpRequest, textStatus){\r\n\t\t\t\tif (typeof XMLHttpRequest == 'object' && typeof XMLHttpRequest.result != 'undefined')\r\n\t\t\t\t{\r\n\t\t\t\t\tvar json = XMLHttpRequest;\r\n\t\t\t\t\tLP.tip.call(_this, json.result, json.message, json.tipType, tipConfig);\r\n\t\t\t\t}\r\n\t\t\t\telse\r\n\t\t\t\t\tswitch(textStatus) {\r\n\t\t\t\t\t\tcase 'timeout':\r\n\t\t\t\t\t\t\t$.toast(QUERY_LANGUAGE.network_timeout);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'error':\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'notmodified':\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tcase 'parsererror':\r\n\t\t\t\t\t\t\t$.toast(QUERY_LANGUAGE.parser_error);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\tdefault:\r\n\t\t\t\t\t\t\t$.toast(QUERY_LANGUAGE.server_error);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t});\r\n\t\treturn $dtd;\r\n\t};\r\n\r\n\t$.fn.extend({\r\n\tquery : function(callback, tipConfig) {\r\n\t\treturn this.each(function() {\r\n\t\t\tvar $this = $(this);\r\n\t\t\tvar is_form = $this.is('form');\r\n\t\t\tvar on = $this.data('lp-query');\r\n\t\t\tif (on)\r\n\t\t\t\t$this.off(is_form ? 'submit': 'click', on);\r\n\t\t\tif (callback == 'destroy') return;\r\n\t\t\t//bind\r\n\t\t\tvar validator = is_form ? $this.data('validator') : null;\r\n\t\t\tif (validator) validator.settings.submitHandler = function(f, e) {};\r\n\t\t\ton = function(e) {\r\n\t\t\t\tvar selector = $this.attr('selector');\r\n\t\t\t\tif ($this.is('.disabled,[disabled]')) return false;\r\n\t\t\t\tvar $selector = is_form ? $this.add(selector) : $(selector);\r\n\t\t\t\tif (validator && !$.isEmptyObject(validator.invalid)) //validator is invalid\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t\r\n\t\t\t\tif((selector || is_form) && $selector.serializeArray().length <= 0) //selector is set,but nothing to query\r\n\t\t\t\t{\r\n\t\t\t\t\t$.toast(QUERY_LANGUAGE.unselected);\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tvar url = $this.attr(is_form ? 'action' : 'href');\r\n\t\t\t\tvar method = $this.attr('method');\r\n\t\t\t\tvar msg = $this.attr('confirm');\r\n\t\t\t\tvar query = function(){\r\n\t\t\t\t\tvar $doms = is_form ? $(':submit,:image', $this)/*.add($this)*/ : $this;\r\n\t\t\t\t\t$doms = $doms.filter(':not(.disabled,[disabled])');\r\n\t\t\t\t\t$doms.prop('disabled',true).attr('disabled','disabled').each(function(){\r\n\t\t\t\t\t\tvar $t = $(this);var o = $t.offset();\r\n\t\t\t\t\t\tif (show_loading) $('<div style=\"position:absolute;left:'+(o.left + $t.width())+'px;top:'+(o.top - 16) +'px;height:16px;width:16px;display:block;z-index:99999\" class=\"query-loading\"><img src=\"data:image/gif;base64,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\"</div>').appendTo('body');\r\n\t\t\t\t\t}); //disabled the submit button\r\n\r\n\t\t\t\t\treturn LP.queryTip.call($this, method, url, $selector.serializeArray(), tipConfig).done(function(json){\r\n\t\t\t\t\t\tif (typeof callback != 'undefined' && $.isFunction(callback))\r\n\t\t\t\t\t\t\tcallback.call($this, json);\r\n\t\t\t\t\t}).always(function(){\r\n\t\t\t\t\t\t$('.query-loading').remove();\r\n\t\t\t\t\t\t$doms.prop('disabled',false).removeAttr('disabled');\r\n\t\t\t\t\t});\r\n\t\t\t\t};\r\n\t\t\t\tif (msg) {\r\n\t\t\t\t\tmsg = msg.replace('%L', $selector.serializeArray().length);\r\n\t\t\t\t\t$.confirm(msg, query);\r\n\t\t\t\t} else\r\n\t\t\t\t\tquery.call(this);\r\n\t\t\t\te.stopImmediatePropagation();\r\n\t\t\t\treturn false;\r\n\t\t\t};\r\n\t\t\t$this.on(is_form ? 'submit': 'click', on).data({'lp-query': on});\r\n\t\t});\r\n\t}\r\n\t});\r\n\r\n\t$.baseuri = LP.baseuri;\r\n\t$.LP = LP;\r\n\r\n})(jQuery);"]}